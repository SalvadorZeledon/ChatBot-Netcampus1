<div id="nc-bot" class="nc" style="font-family: system-ui,Arial;">
  <section id="view-chat" class="view active" aria-hidden="false">
  <div class="nc-card">
    <strong class="nc-header"><img src="LogoUso1.svg" alt="Logo" width="22" height="22" style="margin-right: 10px;">Chatbot de Prueba - Unidad TAC</strong>

    <div class="nc-toolbar">
      <button id="nc-theme" class="nc-theme-btn" type="button" aria-pressed="false" title="Cambiar tema">
        üåô Modo oscuro
      </button>
      <button id="toFaq" class="nc-theme-btn" type="button" title="Ir a Preguntas frecuentes">‚ùì Preguntas frecuentes</button>
    </div>


    <div id="nc-msgs" class="nc-msgs"></div>
    <div id="nc-quick" class="nc-quick">
      <button class="nc-chip" data-q="¬øPuedes comentarme en qu√© consiste el nuevo proyecto de la Unidad TAC?">Proyecto TAC</button>
      <button class="nc-chip" data-q="¬øCu√°ndo inicia y cu√°ndo termina el ciclo 02-2025?">Calendario</button>
      <button class="nc-chip" data-q="¬øCu√°les son las pol√≠ticas de evaluaci√≥n?">Pol√≠ticas</button>
     <button class="nc-chip" data-q="¬øTienes un video para matriculaci√≥n?">Video matriculaci√≥n</button>
    </div>

    <div id="nc-form" class="nc-form" style="position:relative">
      <input id="nc-input" class="nc-input" type="text" placeholder="Escribe tu pregunta‚Ä¶" required autocomplete="off">
      <button id="nc-send" class="nc-send" type="button">Enviar</button>
      <div id="chat-suggestions" class="nc-suggest-list" style="display:none"></div>
    </div>
  </div>
  </section>

  <section id="view-faq" class="view" aria-hidden="true">
  <header class="faq-header">
    <div class="faq-wrap faq-toolbar">
      <div class="faq-header-left">
        <img src="LogoUso1.svg" alt="Logo" width="28" height="28">
        <h2 class="faq-title" id="faqTitle" tabindex="-1"><span>Preguntas Frecuentes</span></h2>
      </div>
      <div class="faq-header-right">
        <button id="backToBot" class="back-btn" type="button" title="Volver al chatbot">‚Üê Volver al Chatbot</button>
        <button id="themeToggleFaq" class="back-btn" type="button" title="Cambiar tema">üåô</button>
      </div>
    </div>
  </header>

  <div class="faq-search">
    <input type="text" id="searchInput" placeholder="Buscar preguntas..." autocomplete="off" />
    <div id="questions-suggestions" class="nc-suggest-list" style="display:none"></div>
  </div>

  <div class="faq-wrap faq-pills">
    <button class="pill" onclick="showSection('estudiante')">Estudiante</button>
    <button class="pill" onclick="showSection('docente')">Docente</button>
  </div>
  <div class="faq-wrap faq-actions">
    <button id="expandAllBtn" class="pill">Expandir Todo</button>
    <button id="collapseAllBtn" class="pill">Contraer Todo</button>
  </div>

  <div id="estudiante" class="section active">
    <h2 style="text-align:center;margin-top:0">Secci√≥n para Estudiantes</h2>
    <details>
            <summary>1. ¬øC√≥mo modificar tu perfil?</summary>
            <div class="answer">
                <ul>
                    <li>Inicia sesi√≥n en la plataforma.</li>
                    <li>Haz clic en tu nombre o tu foto en la esquina superior.</li>
                    <li>Selecciona Perfil.</li>
                    <li>En la p√°gina de tu perfil, pulsa en Editar perfil.</li>
                    <li>Podr√°s cambiar: nombre, apellidos, direcci√≥n de correo, descripci√≥n personal, idioma preferido, etc.</li>
                    <li>Una vez hechos los cambios, selecciona Guardar cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>2. ¬øC√≥mo a√±adir una foto a tu perfil?</summary>
            <div class="answer">
                <ul>
                    <li>Accede a tu perfil como en el paso anterior.</li>
                    <li>En Editar perfil, busca la secci√≥n Imagen del usuario.</li>
                    <li>Arrastra y suelta tu foto en el √°rea designada o selecciona Agregar archivo.</li>
                    <li>Haz clic en Guardar cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>3. ¬øC√≥mo recuperar la contrase√±a?</summary>
            <div class="answer">
                <ul>
                    <li>En la pantalla de inicio de sesi√≥n, selecciona la opci√≥n ¬øOlvid√≥ su nombre de usuario o contrase√±a?</li>
                    <li>Ingresa tu direcci√≥n de correo registrada o tu nombre de usuario.</li>
                    <li>Recibir√°s un mensaje de correo con un enlace para restablecer la contrase√±a.</li>
                    <li>Haz clic en el enlace y crea una nueva clave de acceso.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>4. ¬øC√≥mo puedo auto matricularme en un curso?</summary>
            <div class="answer">
                <ul>
                    <li>Inicia sesi√≥n en Sinapsis.</li>
                    <li>Ve al listado de cursos disponibles.</li>
                    <li>Haz clic en el curso al que deseas unirte.</li>
                    <li>Si el curso tiene activada la auto-matriculaci√≥n, aparecer√° un bot√≥n "Matricularme".</li>
                    <li>Si se requiere una clave de acceso, introd√∫cela y confirma.</li>
                    <li>Una vez matriculado, el curso aparecer√° en tu p√°gina principal.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>5. ¬øC√≥mo puedo matricularme si el curso tiene clave?</summary>
            <div class="answer">
                <ul>
                    <li>Inicia sesi√≥n en Sinapsis.</li>
                    <li>Ve al listado de cursos disponibles.</li>
                    <li>Haz clic en el curso al que deseas unirte.</li>
                    <li>Si el curso tiene clave, dir√≠gete a la p√°gina de la "Universidad de Sonsonate", ve a servicios y busca "Horarios de Claves de Sinapsis y Teams".</li>
                    <li>Ingresa en esa secci√≥n y busca por d√≠a la clave de la materia que necesitas.</li>
                    <li>Regresa a Sinapsis y introduce la clave de acceso y confirma.</li>
                    <li>Una vez matriculado, el curso aparecer√° en tu p√°gina principal.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>6. ¬øD√≥nde puedo ver la descripci√≥n de un curso?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa a la p√°gina principal del curso.</li>
                    <li>La descripci√≥n del curso se encuentra en la parte superior o en la secci√≥n inicial.</li>
                    <li>All√≠ ver√°s los objetivos, criterios de evaluaci√≥n y actividades programadas.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>7. ¬øC√≥mo participo en un foro?</summary>
            <div class="answer">
                <ul>
                    <li>Dentro del curso, localiza la actividad Foro.</li>
                    <li>Haz clic en el t√≠tulo del foro.</li>
                    <li>Selecciona un tema ya existente o pulsa "A√±adir un nuevo tema de discusi√≥n".</li>
                    <li>Escribe el asunto y tu mensaje.</li>
                    <li>Puedes adjuntar archivos o im√°genes.</li>
                    <li>Haz clic en "Enviar al foro".</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>8. ¬øD√≥nde veo mis calificaciones?</summary>
            <div class="answer">
                <ul>
                    <li>En el curso, abre el men√∫ lateral.</li>
                    <li>Haz clic en "Calificaciones".</li>
                    <li>Se mostrar√° la libreta de calificaciones con tus tareas, cuestionarios y la retroalimentaci√≥n del profesor.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>9. ¬øC√≥mo recibo notificaciones y retroalimentaci√≥n?</summary>
            <div class="answer">
                <ul>
                    <li>Revisa la campana de notificaciones en la barra superior.</li>
                    <li>Ah√≠ ver√°s avisos de nuevas tareas, calificaciones o mensajes.</li>
                    <li>Tambi√©n puedes activar notificaciones por correo electr√≥nico o SMS desde tu perfil ‚Üí Preferencias ‚Üí Preferencias de Notificaciones.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>10. ¬øC√≥mo puedo ordenar mis cursos?</summary>
            <div class="answer">
                <ul>
                    <li>Ve a la p√°gina principal de tu √°rea personal.</li>
                    <li>En la secci√≥n "Mis cursos", usa las opciones de ordenamiento.</li>
                    <li>Selecciona ordenar por fecha de inicio o alfab√©ticamente.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>11. ¬øQu√© significa que un curso muestre fechas como "Hoy / Ma√±ana / Ayer"?</summary>
            <div class="answer">
                <ul>
                    <li>En Moodle 5.0, las fechas de las actividades y eventos aparecen con un formato natural:</li>
                    <li>Hoy: actividades que vencen en el mismo d√≠a.</li>
                    <li>Ma√±ana: pr√≥ximas actividades.</li>
                    <li>Ayer: actividades pasadas.</li>
                    <li>Esto facilita la comprensi√≥n del calendario.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>12. ¬øC√≥mo consultar mis entregas y penalizaciones por retraso?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa a tu curso.</li>
                    <li>Dir√≠gete a la secci√≥n Tareas o Actividades.</li>
                    <li>Haz clic en la tarea que deseas revisar.</li>
                    <li>Ver√°s tu fecha de entrega, el estado de la entrega y cualquier retroalimentaci√≥n del docente.</li>
                    <li>Si hubo retraso en la entrega, Moodle mostrar√° las penalizaciones aplicadas autom√°ticamente seg√∫n la configuraci√≥n de la tarea.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>13. ¬øC√≥mo puedo hacer que los contenidos H5P se reproduzcan autom√°ticamente en la app m√≥vil de Moodle?</summary>
            <div class="answer">
                <ul>
                    <li>Abrir la actividad H5P dentro de la app.</li>
                    <li>Algunos tipos de contenido H5P, como videos interactivos, permiten configurar la reproducci√≥n autom√°tica desde el editor H5P en el navegador web.</li>
                    <li>Una vez configurada, al abrir el contenido desde la app m√≥vil, comenzar√° autom√°ticamente la reproducci√≥n si la actividad lo permite.</li>
                    <li>Nota: No todos los contenidos H5P admiten reproducci√≥n autom√°tica en dispositivos m√≥viles debido a restricciones del navegador y la app.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>14. ¬øC√≥mo entregar tareas (con l√≠mite de 20 MB)?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso y selecciona la actividad Tarea.</li>
                    <li>Lee las instrucciones y verifica la fecha l√≠mite.</li>
                    <li>Haz clic en Agregar entrega.</li>
                    <li>Adjunta el archivo desde tu computadora (m√°ximo 20 MB, seg√∫n configuraci√≥n del curso).</li>
                    <li>Haz clic en Guardar cambios.</li>
                    <li>Si lo deseas, selecciona Enviar tarea para confirmarla de forma definitiva.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
        <details>
            <summary>15. ¬øC√≥mo resolver cuestionarios (ex√°menes virtuales)?</summary>
            <div class="answer">
                <ul>
                    <li>Entra al curso y selecciona el cuestionario.</li>
                    <li>Lee la informaci√≥n inicial: fecha de apertura, tiempo l√≠mite y n√∫mero de intentos.</li>
                    <li>Haz clic en Intentar resolver el cuestionario ahora.</li>
                    <li>Responde cada pregunta siguiendo las indicaciones (opci√≥n m√∫ltiple, verdadero/falso, ensayo, etc.).</li>
                    <li>Al finalizar, selecciona Finalizar intento.</li>
                    <li>Revisa tus respuestas y luego confirma con Enviar todo y terminar.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
  </div>

  <div id="docente" class="section">
    <h2 style="text-align:center;margin-top:0">Secci√≥n para Docentes</h2>
    <details>
            <summary>1. ¬øC√≥mo activar la automatr√≠cula en un curso?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso donde quieres habilitar la automatr√≠cula.</li>
                    <li>En el men√∫ del curso selecciona Participantes.</li>
                    <li>Haz clic en el men√∫ desplegable y elige M√©todos de inscripci√≥n.</li>
                    <li>Ver√°s una lista de m√©todos disponibles. Localiza Automatr√≠cula y act√≠valo haciendo clic en el √≠cono del "ojo" para que quede visible.</li>
                    <li>Para configurarlo, selecciona el √≠cono de ajustes junto a "Automatr√≠cula".</li>
                    <li>Define si deseas usar una clave de inscripci√≥n (contrase√±a de acceso).</li>
                    <li>Ajusta la duraci√≥n de la matr√≠cula, fecha de inicio o fin, n√∫mero m√°ximo de usuarios y mensajes de bienvenida.</li>
                    <li>Guarda los cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>2. ¬øC√≥mo matricular usuarios manualmente en un curso?</summary>
            <div class="answer">
                <ul>
                    <li>Entra al curso.</li>
                    <li>Ve a la secci√≥n Participantes.</li>
                    <li>En el men√∫, selecciona M√©todos de inscripci√≥n.</li>
                    <li>Comprueba que el m√©todo Matr√≠cula manual est√© activo (√≠cono de ojo abierto).</li>
                    <li>Haz clic en Matricular usuarios.</li>
                    <li>Selecciona a las personas que deseas inscribir.</li>
                    <li>Asigna un rol (por ejemplo, estudiante).</li>
                    <li>Si lo deseas, establece una duraci√≥n de la matr√≠cula o fecha de inicio y fin.</li>
                    <li>Confirma con Matricular usuarios seleccionados.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>3. ¬øC√≥mo a√±adir la descripci√≥n del curso?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso y haz clic en Configuraci√≥n del curso.</li>
                    <li>Dentro del apartado General, localiza el campo Descripci√≥n.</li>
                    <li>Escribe un resumen claro que explique los objetivos, contenidos y metodolog√≠a del curso.</li>
                    <li>Si lo deseas, adjunta archivos o im√°genes de apoyo.</li>
                    <li>Guarda los cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>4. ¬øC√≥mo configurar la calificaci√≥n del curso?</summary>
            <div class="answer">
                <ul>
                    <li>Entra al curso y abre el men√∫ Calificaciones.</li>
                    <li>Haz clic en Ajustes de la calificaci√≥n del curso.</li>
                    <li>Aqu√≠ puedes:</li>
                    <li>Organizar categor√≠as (por ejemplo: ex√°menes, tareas, participaci√≥n).</li>
                    <li>Definir el peso de cada actividad.</li>
                    <li>Ajustar el m√©todo de c√°lculo (suma de calificaciones, media ponderada, etc.).</li>
                    <li>Guarda los cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>5. ¬øC√≥mo crear una tarea?</summary>
            <div class="answer">
                <ul>
                    <li>Entra al curso y activa la edici√≥n.</li>
                    <li>En la secci√≥n donde quieras colocar la tarea, haz clic en A√±adir una actividad o recurso.</li>
                    <li>Selecciona Tarea y pulsa Agregar.</li>
                    <li>Completa los campos: nombre de la tarea, descripci√≥n e instrucciones.</li>
                    <li>Configura fechas de inicio y entrega.</li>
                    <li>Establece el tama√±o m√°ximo de archivo (ejemplo: 20 MB).</li>
                    <li>Ajusta la calificaci√≥n (puntuaci√≥n m√°xima, categor√≠as).</li>
                    <li>Guarda y regresa al curso.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>6. ¬øC√≥mo redactar preguntas generadoras para foros de discusi√≥n?</summary>
            <div class="answer">
                <ul>
                    <li>Activar la edici√≥n. En tu curso, haz clic en el √≠cono de engranaje y selecciona Activar edici√≥n.</li>
                    <li>A√±adir una actividad. Haz clic en A√±adir una actividad o un recurso en la secci√≥n donde quieras colocar el foro.</li>
                    <li>Seleccionar el tipo de actividad. En la ventana emergente, elige la pesta√±a Actividades y selecciona Foro.</li>
                    <li>Configurar el foro:</li>
                    <li>Nombre del foro: Asigna un t√≠tulo claro.</li>
                    <li>Descripci√≥n: Aqu√≠ puedes incluir las instrucciones, las reglas de participaci√≥n y las preguntas generadoras que iniciar√°n el debate.</li>
                    <li>Tipo de foro: Despliega las opciones y selecciona Debate sencillo.</li>
                    <li>Ajustar la disponibilidad, fechas de entrega y l√≠mite.</li>
                    <li>Configurar adjuntos y recuento de palabras.</li>
                    <li>Establecer modalidad de suscripci√≥n (Suscripci√≥n forzosa si quieres participaci√≥n obligatoria).</li>
                    <li>Configurar evaluaci√≥n y calificaci√≥n.</li>
                    <li>Guardar los cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>7. ¬øC√≥mo reutilizar cursos (Importaci√≥n)?</summary>
            <div class="answer">
                <ul>
                    <li>Abre dos ventanas del navegador. En una, abre el curso viejo que contiene toda la informaci√≥n. En la segunda, abre el curso nuevo que est√° vac√≠o.</li>
                    <li>Inicia la importaci√≥n en el curso nuevo. Ve a la opci√≥n de m√°s y busca "Reutilizaci√≥n de Curso" en la parte superior derecha y haz clic en Reutilizaci√≥n de curso. Luego, selecciona Importar.</li>
                    <li>Busca el curso a importar. Regresa a la ventana del curso viejo. Busca y copia el c√≥digo de la asignatura m√°s la sesi√≥n (por ejemplo, ADM-3200-01).</li>
                    <li>Pega este c√≥digo en la barra de b√∫squeda del curso nuevo y haz clic en Buscar.</li>
                    <li>Selecciona el curso. Aseg√∫rate de que el resultado de la b√∫squeda coincida con el curso viejo. Selecci√≥nalo y haz clic en Continuar.</li>
                    <li>Ajusta los elementos a copiar. Moodle te mostrar√° una lista de todos los elementos del curso viejo. Por defecto, todo estar√° seleccionado. Desmarca aquellos que no quieras copiar y haz clic en Siguiente.</li>
                    <li>Confirma la importaci√≥n. Revisa la lista final. Moodle marcar√° en verde lo que se copiar√° y en rojo lo que no. Si todo es correcto, haz clic en Realizar la importaci√≥n.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>8. ¬øC√≥mo puedo crear una actividad H5P en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso y activa el modo edici√≥n.</li>
                    <li>Haz clic en A√±adir actividad o recurso.</li>
                    <li>Selecciona Contenido interactivo H5P y haz clic en Agregar.</li>
                    <li>Escribe un nombre para la actividad y agrega el contenido H5P desde el editor H5P o sube un archivo existente.</li>
                    <li>Configura opciones como calificaci√≥n, intentos y restricciones de acceso.</li>
                    <li>Guarda los cambios y la actividad estar√° disponible para los estudiantes.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>9. ¬øC√≥mo puedo revitalizar o reiniciar un curso en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Ve al curso y selecciona M√°s ‚Üí Reutilizaci√≥n de curso ‚Üí Reiniciar curso.</li>
                    <li>Elige los elementos que deseas reiniciar: calificaciones, actividades, usuarios matriculados, foros, etc.</li>
                    <li>Confirma la acci√≥n. Esto dejar√° el curso listo para un nuevo ciclo sin perder su estructura.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>10. ¬øC√≥mo puedo dise√±ar y aplicar cuestionarios en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Activa el modo edici√≥n y selecciona A√±adir actividad o recurso ‚Üí Cuestionario.</li>
                    <li>Define nombre, descripci√≥n y par√°metros de tiempo, intentos y calificaci√≥n.</li>
                    <li>Agrega preguntas desde el banco de preguntas o crea nuevas (opci√≥n m√∫ltiple, verdadero/falso, respuesta corta, etc.).</li>
                    <li>Publica el cuestionario y los estudiantes podr√°n responder seg√∫n las fechas y configuraciones establecidas.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>11. ¬øC√≥mo puedo filtrar las entregas que ya he calificado en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa a la tarea y haz clic en Ver todas las entregas.</li>
                    <li>Utiliza los filtros para mostrar √∫nicamente:</li>
                    <li>Entregas calificadas</li>
                    <li>Entregas pendientes</li>
                    <li>Entregas con retraso</li>
                    <li>Esto te permite gestionar f√°cilmente las calificaciones y revisiones.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>12. ¬øC√≥mo configuro penalizaciones por entregas tard√≠as en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Al crear o editar una tarea, busca la secci√≥n Entrega o configuraciones.</li>
                    <li>Activa la opci√≥n Fecha l√≠mite y selecciona la penalizaci√≥n por retraso.</li>
                    <li>Moodle aplicar√° autom√°ticamente un porcentaje de descuento en la calificaci√≥n si la entrega se realiza despu√©s de la fecha l√≠mite.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>13. ¬øC√≥mo puedo crear un cuestionario en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso donde deseas crear el cuestionario.</li>
                    <li>Activa el modo edici√≥n haciendo clic en Activar edici√≥n.</li>
                    <li>En la secci√≥n donde quieres agregar el cuestionario, haz clic en A√±adir actividad o recurso.</li>
                    <li>Selecciona Cuestionario y haz clic en Agregar.</li>
                    <li>Completa los campos principales:</li>
                    <li>Nombre del cuestionario: t√≠tulo visible para los estudiantes.</li>
                    <li>Descripci√≥n: instrucciones o informaci√≥n sobre el cuestionario.</li>
                    <li>Configura las opciones de disponibilidad y tiempo:</li>
                    <li>Fecha de apertura y cierre del cuestionario.</li>
                    <li>Tiempo l√≠mite para responder.</li>
                    <li>N√∫mero de intentos permitidos.</li>
                    <li>Configura calificaci√≥n y retroalimentaci√≥n:</li>
                    <li>Escala o puntaje m√°ximo.</li>
                    <li>Tipo de calificaci√≥n (promedio de intentos, calificaci√≥n m√°s alta, etc.).</li>
                    <li>Guarda los cambios y vuelve al cuestionario.</li>
                    <li>Haz clic en Editar cuestionario para agregar preguntas:</li>
                    <li>Puedes crear nuevas preguntas (opci√≥n m√∫ltiple, verdadero/falso, respuesta corta, etc.).</li>
                    <li>O seleccionar preguntas existentes desde el banco de preguntas del curso.</li>
                    <li>Una vez agregadas las preguntas, ajusta el orden y la puntuaci√≥n de cada una.</li>
                    <li>Guarda los cambios y publica el cuestionario.</li>
                    <li>Los estudiantes podr√°n acceder al cuestionario seg√∫n la fecha de apertura y las restricciones que configuraste.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>14. ¬øC√≥mo puedo pre-crear intentos de cuestionarios en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso y abre el cuestionario que deseas configurar.</li>
                    <li>Ve a configuraci√≥n ‚Üí Calificaci√≥n ‚Üí Intentos permitidos.</li>
                    <li>Configura el n√∫mero m√°ximo de intentos que cada estudiante podr√° realizar.</li>
                    <li>Si deseas que ciertos intentos ya est√©n pre-creados para an√°lisis o pruebas, puedes utilizar la opci√≥n Simular intentos desde el cuestionario.</li>
                    <li>Confirma los cambios. Esto permitir√° que los estudiantes tengan los intentos listos seg√∫n la configuraci√≥n, y tambi√©n podr√°s visualizar resultados de prueba.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>15. ¬øC√≥mo gestiono el banco de preguntas en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso y ve a Banco de preguntas ‚Üí Preguntas en el men√∫ de administraci√≥n.</li>
                    <li>Crear una pregunta:</li>
                    <li>Haz clic en Agregar ‚Üí Tipo de pregunta (opci√≥n m√∫ltiple, verdadero/falso, etc.).</li>
                    <li>Completa el enunciado, las opciones de respuesta y la calificaci√≥n.</li>
                    <li>Guarda los cambios.</li>
                    <li>Duplicar una pregunta:</li>
                    <li>Selecciona la pregunta que deseas duplicar.</li>
                    <li>Haz clic en Duplicar, luego ajusta el contenido seg√∫n necesites y guarda.</li>
                    <li>Filtrar preguntas:</li>
                    <li>Utiliza los filtros por categor√≠a, tipo o palabras clave para encontrar preguntas espec√≠ficas r√°pidamente.</li>
                    <li>Compartir preguntas:</li>
                    <li>Selecciona las preguntas deseadas.</li>
                    <li>Haz clic en Exportar y elige el formato (Moodle XML, GIFT, etc.).</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>16. ¬øC√≥mo puedo a√±adir descripciones largas a im√°genes en Moodle 5.0 para mejorar la accesibilidad?</summary>
            <div class="answer">
                <ul>
                    <li>Al agregar o editar una imagen en cualquier actividad o recurso, haz clic en la imagen dentro del editor de texto.</li>
                    <li>Busca la opci√≥n Propiedades de la imagen ‚Üí Texto alternativo y escribe un resumen breve.</li>
                    <li>Para descripciones largas, haz clic en Descripci√≥n larga o Long description (dependiendo del editor).</li>
                    <li>Escribe un detalle completo sobre la imagen, explicando su contenido y contexto.</li>
                    <li>Guarda los cambios.</li>
                    <li>Esto permite que los lectores de pantalla describan correctamente la imagen, cumpliendo normas de accesibilidad.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>17. ¬øC√≥mo puedo configurar plantillas de respaldos en Moodle 5.0?</summary>
            <div class="answer">
                <ul>
                    <li>Ingresa al curso y ve a m√°s ‚Üí Reutilizaci√≥n de curso ‚Üí Copia de seguridad.</li>
                    <li>Define los elementos que deseas incluir en el respaldo: actividades, bloques, calificaciones, usuarios, filtros, etc.</li>
                    <li>Guarda la plantilla con un nombre identificativo.</li>
                    <li>Ahora podr√°s usar esta plantilla para generar respaldos r√°pidos del curso sin necesidad de configurar cada opci√≥n nuevamente.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>18. ¬øQu√© son las etiquetas y c√≥mo usarlas?</summary>
            <div class="answer">
                <ul>
                    <li>Las etiquetas en Moodle son un recurso que permite a√±adir texto, im√°genes, videos o enlaces directamente en la p√°gina del curso.</li>
                    <li>Para insertarlas:</li>
                    <li>Activa la edici√≥n en el curso.</li>
                    <li>Haz clic en A√±adir una actividad o recurso en la secci√≥n deseada.</li>
                    <li>Selecciona √Årea de texto y medios.</li>
                    <li>Escribe el contenido: puede ser un t√≠tulo, una nota, un recordatorio, una imagen o un video incrustado.</li>
                    <li>Guarda los cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>19. ¬øC√≥mo usar el banco de preguntas?</summary>
            <div class="answer">
                <ul>
                    <li>Entender los niveles del banco de preguntas: Nivel del sistema, Nivel de categor√≠a, Nivel del curso.</li>
                    <li>Acceder al banco de preguntas: Ve a tu curso, en M√°s selecciona Banco de preguntas.</li>
                    <li>Crear una nueva pregunta: Selecciona tipo (opci√≥n m√∫ltiple, verdadero/falso, etc.), configura y guarda.</li>
                    <li>Exportar e importar preguntas: Usa pesta√±as Exportar/Importar con formato Moodle XML.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>20. ¬øC√≥mo crear una nueva pregunta en el banco de preguntas?</summary>
            <div class="answer">
                <ul>
                    <li>Dentro del banco de preguntas, haz clic en el bot√≥n Crear una nueva pregunta.</li>
                    <li>Moodle te presentar√° una variedad de tipos de preguntas para elegir: Opci√≥n m√∫ltiple, Verdadero/Falso, Emparejamiento, Respuesta corta, Ensayo.</li>
                    <li>Selecciona el tipo de pregunta que deseas y haz clic en A√±adir.</li>
                    <li>Configura la pregunta: nombre de la pregunta, enunciado de la pregunta, opciones de respuesta.</li>
                    <li>Haz clic en Guardar cambios. La nueva pregunta se guardar√° en tu banco.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>21. ¬øC√≥mo exportar e importar preguntas?</summary>
            <div class="answer">
                <ul>
                    <li>Exportar preguntas: En el banco de preguntas, haz clic en la pesta√±a Exportar. Selecciona el formato de archivo deseado (Moodle XML es el m√°s com√∫n). Elige la categor√≠a que deseas exportar y haz clic en Exportar preguntas a archivo.</li>
                    <li>Importar preguntas: En el banco de preguntas, haz clic en la pesta√±a Importar. Selecciona el formato de archivo (por ejemplo, Moodle XML). Arrastra y suelta el archivo o utiliza el selector de archivos para subirlo desde tu computadora. Haz clic en Importar para a√±adir las preguntas a tu banco.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>

        <details>
            <summary>22. ¬øC√≥mo poner nombre a un curso (consejos)?</summary>
            <div class="answer">
                <ul>
                    <li>Al crear o editar un curso, ingresa a Configuraci√≥n del curso.</li>
                    <li>En el campo Nombre completo del curso, escribe el t√≠tulo que se mostrar√° a los estudiantes.</li>
                    <li>En Nombre corto del curso, coloca una versi√≥n abreviada (ejemplo: MAT101).</li>
                    <li>Guarda los cambios.</li>
                </ul>
                <a href="https://www.youtube.com/watch?v=placeholder" target="_blank" class="video-link">Ver Video Tutorial</a>
            </div>
        </details>
  </div>
  </section>

</div>

<style>
  :root{
    --nc-primary:#1f57b6;  /* azul institucional */
    --nc-accent:#19b36b;   /* verde acento */
    --nc-danger:#d9534f;   /* rojo para botones de video */
    --nc-bg:#f6f9ff;
    --nc-text:#111;
  }

  .nc{color:var(--nc-text)}
  .nc-card{
    border:1px solid #e6e8f0; border-radius:16px; background:#fff;
    box-shadow:0 14px 38px rgba(0,0,0,.06); max-width:820px; margin:8px auto;
  }
  .nc-header{
    display:block; padding:14px 16px; border-radius:16px 16px 0 0; color:#fff;
    background:linear-gradient(90deg,var(--nc-primary), var(--nc-accent));
    font-weight:800; letter-spacing:.2px;
  }
  .nc-msgs{padding:16px; max-height:420px; overflow:auto; background:var(--nc-bg)}
  .nc-bubble{
    margin:10px 0; max-width:82%; padding:10px 12px; border-radius:14px; line-height:1.45;
    box-shadow:0 3px 10px rgba(0,0,0,.05); border:1px solid #e8ecf6; word-wrap:break-word;
  }
  .nc-bubble.nc-bot{background:#fff}
  .nc-bubble.nc-me {background:#e8f2ff; border-color:#cfe1ff; margin-left:auto}

  .nc-form{display:flex; gap:10px; padding:14px 16px; border-top:1px solid #eef2ff; background:#fff; border-radius:0 0 16px 16px}
  .nc-input{flex:1; padding:12px 14px; border:1px solid #d8dce8; border-radius:12px; background:#fbfbfe}
  .nc-send{padding:12px 16px; border-radius:12px; border:1px solid var(--nc-primary); background:var(--nc-primary); color:#fff; cursor:pointer; font-weight:700}
  .nc-send:hover{filter:brightness(.96)}

  /* Botones tipo enlace dentro de respuestas del bot */
  #nc-msgs a{
    display:inline-block; padding:8px 12px; border-radius:10px; text-decoration:none; font-weight:700;
    border:1px solid var(--nc-primary); background:#eef1ff; color:var(--nc-primary); margin-top:6px;
  }
  #nc-msgs a.primary{background:var(--nc-primary); color:#fff}
  #nc-msgs a.success{background:var(--nc-accent); color:#fff; border-color:var(--nc-accent)}
  #nc-msgs a.danger{background:var(--nc-danger); color:#fff; border-color:var(--nc-danger)}

  .nc-quick{display:flex;flex-wrap:wrap;gap:10px;padding:10px 16px;border-top:1px solid #eef2ff;background:#fbfdff}
  .nc-chip{
    background:#eef4ff;border:1px solid #dbe6ff;color:var(--nc-primary);
    border-radius:999px;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:600
  }
  .nc-chip:hover{background:#e2ecff}

</style>

<style>
  /* FAQ styles replicated from index */
  .faq-header { border: 1px solid #e6e8f0; border-radius: 16px; background: linear-gradient(90deg, var(--nc-primary), var(--nc-accent)); color:#fff; box-shadow: 0 14px 38px rgba(0,0,0,.06); max-width: 820px; margin: 8px auto; }
  .faq-toolbar { display:flex; justify-content: space-between; align-items: center; gap: 30px; flex-wrap: wrap; padding: 20px 24px; }
  .faq-header-left { display:flex; align-items:center; gap:16px; }
  .faq-header-right { display:flex; align-items:center; gap:12px; margin-left:auto; }
  .faq-title { margin:0; font-size: 22px; font-weight: 800; }
  .back-btn { padding:8px 12px;border-radius:10px;border:1px solid #dbe6ff;background:#eef4ff;color:var(--nc-primary);font-weight:700;cursor:pointer }
  .back-btn:hover{ background:#e2ecff }

  .faq-search { display:flex; gap:10px; max-width:820px; margin:-8px auto 14px; position:relative }
  .faq-search input { width:100%; padding:12px 16px; border-radius:999px; border:2px solid #e6e8f0; background:#fff; color:#111827 }
  #questions-suggestions { position:absolute; top:100%; left:0; right:0; background:#fff; border:1px solid #dbe6ff; border-top:none; border-radius:0 0 12px 12px; max-height:300px; overflow-y:auto; z-index:1000; box-shadow: 0 14px 38px rgba(0,0,0,.06) }

  .faq-pills { display:flex; gap:10px; justify-content:center; max-width:820px; margin:0 auto 10px }
  .faq-actions { display:flex; gap:10px; justify-content:flex-end; max-width:820px; margin:0 auto 10px }
  .pill { padding:8px 12px; border-radius:10px; border:1px solid #dbe6ff; background:#eef4ff; color:var(--nc-primary); font-weight:700; cursor:pointer }
  .pill:hover{ background:#e2ecff }

  .section { display:none; max-width:820px; margin:0 auto; background:#fff; padding:20px; border-radius:16px; border:1px solid #e6e8f0 }
  .section.active { display:block }
  .section h2 { color: var(--nc-primary); text-align:center; margin:6px 0 16px }

  details { margin-bottom:12px; border:1px solid #dbe6ff; border-radius:10px; overflow:hidden; background:#eef4ff }
  summary { padding:14px 44px 14px 14px; background:#eef4ff; cursor:pointer; font-weight:600; position:relative; color:#111827 }
  summary::-webkit-details-marker { display:none }
  summary::after { content:'‚ñæ'; position:absolute; right:16px; top:50%; transform:translateY(-50%); font-size:1.2em; transition: transform .25s }
  details[open] > summary::after { transform: translateY(-50%) rotate(180deg) }
  .answer { padding:0 14px; line-height:1.65; background:#fff; overflow:hidden; max-height:0; transition:max-height .3s ease-out, padding .3s ease-out; color:#111827 }
  .answer ul { margin:8px 0 8px 20px }
  .answer li { margin:4px 0 }
  details[open] .answer { padding:14px; max-height:1200px; transition:max-height .45s ease-in, padding .45s ease-in }

  /* Dark mode mapped to .nc-dark */
  .nc.nc-dark .faq-header { background: linear-gradient(90deg, #1b3e8e, #146a43); color:#fff; border-color:#2a2e3f; box-shadow:none }
  .nc.nc-dark .faq-search input { background:#0f1220; color:#f5f7ff; border-color:#2a3353 }
  .nc.nc-dark #questions-suggestions { background:#1b2138; border-color:#2a3353 }
  .nc.nc-dark .pill, .nc.nc-dark .back-btn { background:#1b2138; border-color:#2a3353; color:#ffffff }
  .nc.nc-dark .pill:hover, .nc.nc-dark .back-btn:hover { background:#232b49 }
  .nc.nc-dark .section { background:#14182a; border-color:#2a2e3f; color:#f5f7ff }
  .nc.nc-dark details { border-color:#2a3353; background:#1b2138 }
  .nc.nc-dark summary { background:#1b2138; color:#f5f7ff }
  .nc.nc-dark .answer { background:#14182a; color:#f5f7ff }
</style>

<style>
  /* Modo oscuro independiente para FAQ */
  body.faq-dark-bg { background: #0f1220; }
  #view-faq.faq-dark .faq-header { background: linear-gradient(90deg, #1b3e8e, #146a43); color:#fff; border-color:#2a2e3f; box-shadow:none }
  #view-faq.faq-dark .faq-search input { background:#0f1220; color:#f5f7ff; border-color:#2a3353 }
  #view-faq.faq-dark #questions-suggestions { background:#1b2138; border-color:#2a3353 }
  #view-faq.faq-dark .pill, #view-faq.faq-dark .back-btn { background:#1b2138; border-color:#2a3353; color:#ffffff }
  #view-faq.faq-dark .pill:hover, #view-faq.faq-dark .back-btn:hover { background:#232b49 }
  #view-faq.faq-dark .section { background:#14182a; border-color:#2a2e3f; color:#f5f7ff }
  #view-faq.faq-dark details { border-color:#2a3353; background:#1b2138 }
  #view-faq.faq-dark summary { background:#1b2138; color:#f5f7ff }
  #view-faq.faq-dark .answer { background:#14182a; color:#f5f7ff }
</style>

<style>
  /* Lista de sugerencias del chat */
  .nc-suggest-list{
    position:absolute; left:16px; right:16px; bottom:100%; transform: translateY(-6px);
    background:#fff; border:1px solid #dbe6ff; border-radius:10px; box-shadow:0 14px 38px rgba(0,0,0,.06);
    max-height:260px; overflow:auto; z-index:20;
  }
  .nc-suggest-item{padding:10px 12px; cursor:pointer}
  .nc-suggest-item:hover, .nc-suggest-item.active{background:#eef4ff}
  .nc.nc-dark .nc-suggest-list{background:#1b2138; border-color:#2a3353}
  .nc.nc-dark .nc-suggest-item:hover, .nc.nc-dark .nc-suggest-item.active{background:#232b49}
</style>

<style>
  .nc-typing{display:inline-flex;gap:4px;align-items:center}
  .nc-dot-typing{
    width:6px;height:6px;border-radius:50%;background:#9aa7c7;
    opacity:.6;animation:nc-bounce 1s infinite ease-in-out;
  }
  .nc-dot-typing:nth-child(2){animation-delay:.15s}
  .nc-dot-typing:nth-child(3){animation-delay:.3s}

  @keyframes nc-bounce{
    0%,80%,100%{transform:translateY(0);opacity:.6}
    40%{transform:translateY(-4px);opacity:1}
  }
</style>

<style>
  .nc-suggest{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .nc-suggest .nc-chip{
    background:#eef4ff;border:1px solid #dbe6ff;color:var(--nc-primary);
    border-radius:999px;padding:6px 10px;cursor:pointer;font-size:12px;font-weight:600
  }
  .nc-suggest .nc-chip:hover{background:#e2ecff}
</style>

<style>
  .nc-media{margin-top:10px}
  .nc-media img{
    max-width:100%;
    height:auto;
    display:block;
    border-radius:12px;
    border:1px solid #e6e8f0;
    box-shadow:0 6px 16px rgba(0,0,0,.06);
  }
</style>

<style>
  /* Barra superior con bot√≥n de tema */
  .nc-toolbar{display:flex;justify-content:flex-end;gap:8px;padding:8px 12px;background:#fff;border-bottom:1px solid #eef2ff}
  .nc-theme-btn{
    padding:8px 12px;border-radius:10px;border:1px solid var(--nc-primary);
    background:var(--nc-primary);color:#fff;font-weight:700;cursor:pointer
  }
  .nc-theme-btn:hover{filter:brightness(.96)}

  /* ---- Tema oscuro mejor contraste ---- */
.nc.nc-dark {
  color: #e8ecf7; /* Texto general claro */
}

.nc.nc-dark .nc-card {
  background: #14182a;
  border-color: #2a2e3f;
  box-shadow: none;
}

.nc.nc-dark .nc-header {
  background: linear-gradient(90deg, #1b3e8e, #146a43);
  color: #ffffff;
}

.nc.nc-dark .nc-toolbar {
  background: #14182a;
  border-bottom-color: #2a2e3f;
}

.nc.nc-dark .nc-msgs {
  background: #0f1220;
}

.nc.nc-dark .nc-bubble.nc-bot {
  background: #1b2138;
  border-color: #2a3353;
  color: #f5f7ff; /* texto claro */
}

.nc.nc-dark .nc-bubble.nc-me {
  background: #21407a;
  border-color: #21407a;
  color: #ffffff;
}

.nc.nc-dark .nc-input {
  background: #0f1220;
  color: #f5f7ff;
  border-color: #2a3353;
}

.nc.nc-dark .nc-send {
  background: #4f8bff;
  border-color: #4f8bff;
  color: #ffffff;
}

.nc.nc-dark #nc-msgs a {
  background: #3b4770;
  border-color: #3b4770;
  color: #ffffff;
}

.nc.nc-dark #nc-msgs a.success {
  background: #58d39a;
  border-color: #58d39a;
  color: #0b0e1a;
}

.nc.nc-dark #nc-msgs a.danger {
  background: #ff6b6b;
  border-color: #ff6b6b;
  color: #0b0e1a;
}

.nc.nc-dark .nc-quick {
  background: #13182a;
  border-top-color: #2a2e3f;
}

.nc.nc-dark .nc-chip {
  background: #1b2138;
  border-color: #2a3353;
  color: #ffffff;
}

.nc.nc-dark .nc-chip:hover {
  background: #232b49;
}

.nc.nc-dark .nc-suggest .nc-chip {
  background: #1b2138;
  border-color: #2a3353;
  color: #ffffff;
}

/* Dots ‚Äúescribiendo‚Ä¶‚Äù visibles */
.nc.nc-dark .nc-dot-typing {
  background: #cfe0ff;
  opacity: 0.9;
}


  /* Dots de ‚Äúescribiendo‚Ä¶‚Äù m√°s visibles en oscuro */
  .nc.nc-dark .nc-dot-typing{background:#cfe0ff;opacity:.8}
</style>

<style>
.respuesta-bloque {
  background: var(--bg-bloque);
  color: var(--texto-bloque);
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid var(--borde-bloque);
}

.boton-video a {
  display: inline-block;
  padding: 8px 12px;
  border-radius: 8px;
  background: #d9534f;
  color: #fff;
  text-decoration: none;
  font-weight: 600;
}

/* Variables para modo claro */
body.light-mode {
  --bg-input-area: #ffffff;
  --bg-input: #f9f9f9;
  --border-input: #ccc;
  --text-input: #000;
  --bg-button: #4a90e2;
  --text-button: #fff;
}

/* Variables para modo oscuro */
body.dark-mode {
  --bg-input-area: #121212;
  --bg-input: #1e1e1e;
  --border-input: #444;
  --text-input: #fff;
  --bg-button: #2979ff;
  --text-button: #fff;
}

/* Contenedor del input y bot√≥n */
#nc-form {
  background: var(--bg-input-area);
  padding: 10px;
  display: flex;
  gap: 5px;
}

/* Input */
#nc-input {
  background: var(--bg-input);
  border: 1px solid var(--border-input);
  color: var(--text-input);
  flex: 1;
  padding: 6px;
  border-radius: 6px;
}

/* Bot√≥n de enviar */
#nc-send {
  background: var(--bg-button);
  color: var(--text-button);
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
}

</style>

<style >
.mensaje-inicial {
  background: var(--bg-msg);
  padding: 6px;
  border-radius: 6px;
  margin: 4px 0;
  border: 1px solid var(--border-msg);
}

.cursor-escribiendo {
  border-right: 1px solid var(--cursor-color);
}

body.light-mode {
  --bg-msg: #f1f1f1;
  --border-msg: #ccc;
  --cursor-color: #333;
}

body.dark-mode {
  --bg-msg: #1f1f1f;
  --border-msg: #444;
  --cursor-color: #fff;
}
</style>
<style>
  /* Vistas exclusivas (pantallas) */
  .view { display: none; }
  .view.active { display: block; }
  /* Animaciones b√°sicas */
  .fade-enter { opacity: 0; transform: translateY(10px); }
  .fade-enter-active { opacity: 1; transform: translateY(0); transition: opacity .25s ease, transform .25s ease; }
  .fade-exit { opacity: 1; transform: translateY(0); }
  .fade-exit-active { opacity: 0; transform: translateY(-6px); transition: opacity .18s ease, transform .18s ease; }
  /* Sugerencias buscador */
  .suggestion-item { padding: 10px 14px; cursor: pointer; }
  .suggestion-item:hover { background: #eef4ff; }
  .highlight { background: #fff0b3; padding: 0 .1em; border-radius: 3px; }
</style>
<p>
  <script>
    (function() {
      // --- util ---
      const norm = s => (s || "")
        .toLowerCase()
        .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
        .replace(/[¬ø?¬°!.,:;()"]/g, " ")
        .replace(/\s+/g, " ")
        .trim();

      // Tema oscuro independiente del FAQ (no afecta al chat)
      (function(){
        const viewFaq = document.getElementById('view-faq');
        const toFaqBtn = document.getElementById('toFaq');
        const backBtn = document.getElementById('backToBot');
        const themeBtnFaq = document.getElementById('themeToggleFaq');
        const FAQ_THEME_KEY = 'faqTheme';

        function setFaqBackground(active){
          if(active) document.body.classList.add('faq-dark-bg'); else document.body.classList.remove('faq-dark-bg');
        }
        function updateFaqThemeButton(isDark){ if(themeBtnFaq) themeBtnFaq.textContent = isDark ? '‚òÄÔ∏è' : 'üåô'; }
        function applyFaqTheme(theme){
          if(!viewFaq) return;
          if(theme==='dark'){
            viewFaq.classList.add('faq-dark');
            updateFaqThemeButton(true);
            localStorage.setItem(FAQ_THEME_KEY,'dark');
            const isActive = viewFaq.classList.contains('active') && viewFaq.getAttribute('aria-hidden') !== 'true';
            setFaqBackground(isActive);
          } else {
            viewFaq.classList.remove('faq-dark');
            updateFaqThemeButton(false);
            localStorage.setItem(FAQ_THEME_KEY,'light');
            setFaqBackground(false);
          }
        }
        // Inicializa seg√∫n preferencia guardada o sistema
        const savedFaqTheme = localStorage.getItem(FAQ_THEME_KEY) || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        applyFaqTheme(savedFaqTheme);

        if(themeBtnFaq){
          themeBtnFaq.addEventListener('click', ()=>{
            const isDark = viewFaq.classList.contains('faq-dark');
            applyFaqTheme(isDark ? 'light' : 'dark');
          });
        }
        if(toFaqBtn){
          toFaqBtn.addEventListener('click', ()=>{
            const saved = localStorage.getItem(FAQ_THEME_KEY) || 'light';
            if(saved === 'dark') setFaqBackground(true);
          });
        }
        if(backBtn){
          backBtn.addEventListener('click', ()=>{ setFaqBackground(false); });
        }
      })();

      // Autocompletado del FAQ (similar al chat)
      (function(){
        const input = document.getElementById('searchInput');
        const list = document.getElementById('questions-suggestions');
        const root = document.getElementById('view-faq');
        let activeIndex = -1;
        let catalog = [];

        function normalize(s){ return (s||'').toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').trim(); }

        function buildCatalog(){
          const items = [];
          if(root){
            root.querySelectorAll('details > summary').forEach(sum=>{
              const text = sum.textContent.trim();
              const sec = sum.closest('.section');
              const sectionId = sec ? sec.id : null;
              items.push({label:text, q:text, target: sum, sectionId: sectionId});
            });
          }
          catalog = items;
        }
        buildCatalog();

        function getActiveSection(){
          const active = root?.querySelector('.section.active');
          return active ? active.id : null;
        }

        function ensureVisible(el){
          const sec = el.closest('.section');
          if(sec && !sec.classList.contains('active')){
            document.getElementById('estudiante')?.classList.remove('active');
            document.getElementById('docente')?.classList.remove('active');
            sec.classList.add('active');
          }
          const det = el.closest('details');
          if(det) det.open = true;
          el.scrollIntoView({behavior:'smooth', block:'center'});
          el.focus({preventScroll:true});
        }

        function render(items){
          if(!items.length){ list.style.display='none'; list.innerHTML=''; activeIndex=-1; return; }
          list.innerHTML = items.map((it,i)=>`<div class="nc-suggest-item${i===0?' active':''}" data-q="${it.q.replace(/"/g,'&quot;')}">${it.label}</div>`).join('');
          list.style.display='block';
          activeIndex = 0;
          Array.from(list.children).forEach((node, idx)=>{
            node.addEventListener('mouseenter', ()=> setActive(idx));
            node.addEventListener('mousedown', (ev)=>{ ev.preventDefault(); completeAndGo(idx); });
          });
        }
        function setActive(idx){
          const nodes = Array.from(list.children);
          nodes.forEach(n=> n.classList.remove('active'));
          if(idx>=0 && idx<nodes.length){ nodes[idx].classList.add('active'); activeIndex=idx; }
        }
        function completeAndGo(idx){
          const nodes = Array.from(list.children);
          if(!nodes.length) return;
          const node = nodes[idx>=0?idx:0];
          const q = node.getAttribute('data-q') || node.textContent.trim();
          input.value = q;
          list.style.display='none'; list.innerHTML=''; activeIndex=-1;
          // localizar y abrir
          const hit = catalog.find(it => it.q === q);
          if(hit && hit.target){ ensureVisible(hit.target); }
        }

        input.addEventListener('input', ()=>{
          const q = normalize(input.value);
          if(!q){ list.style.display='none'; list.innerHTML=''; return; }
          const activeSec = getActiveSection();
          // Primero: items de la secci√≥n activa
          const inActive = catalog.filter(it=> it.sectionId === activeSec && (normalize(it.label).includes(q) || normalize(it.q).includes(q)));
          // Luego: items de otras secciones
          const inOther = catalog.filter(it=> it.sectionId !== activeSec && (normalize(it.label).includes(q) || normalize(it.q).includes(q)));
          const filtered = [...inActive, ...inOther].slice(0,10);
          render(filtered);
        });
        input.addEventListener('keydown', (e)=>{
          const visible = list.style.display==='block';
          if(!visible){
            if(e.key==='Enter'){
              // si no hay lista, busca el mejor match (que incluya el texto) priorizando la secci√≥n activa
              e.preventDefault();
              const q = normalize(input.value);
              if (!q) return;

              const activeSec = getActiveSection();
              // Busca el primer resultado que contenga el texto, priorizando la secci√≥n activa
              let hit = catalog.find(it => it.sectionId === activeSec && normalize(it.label).includes(q));
              
              // Si no se encuentra en la secci√≥n activa, busca en todo el cat√°logo
              if (!hit) {
                hit = catalog.find(it => normalize(it.label).includes(q));
              }

              if(hit){
                ensureVisible(hit.target);
              }
            }
            return;
          }
          const nodes = Array.from(list.children);
          if(e.key==='ArrowDown'){ e.preventDefault(); setActive(Math.min(nodes.length-1, activeIndex+1)); }
          else if(e.key==='ArrowUp'){ e.preventDefault(); setActive(Math.max(0, activeIndex-1)); }
          else if(e.key==='Enter'){ e.preventDefault(); completeAndGo(activeIndex); }
          else if(e.key==='Escape'){ list.style.display='none'; list.innerHTML=''; activeIndex=-1; }
        });
        document.addEventListener('click', (e)=>{ if(!list.contains(e.target) && e.target!==input){ list.style.display='none'; }});

        // Reconstruir cat√°logo al expandir/contraer por si cambian t√≠tulos
        root?.addEventListener('toggle', (e)=>{ if(e.target && e.target.tagName==='DETAILS'){ buildCatalog(); }});
      })();

      // URL de los videos
      const VIDEO_MATRICULACION = "https://www.youtube.com/watch?v=XXXXXXXX";

      const VIDEO_PAGINA = "https://www.youtube.com/watch?v=YYYYYYYY"; // ‚Üê cambia por tu enlace

      const VIDEO_TAREA = "https://www.youtube.com/watch?v=AAAAAAAA"; // ‚Üê pon tu enlace real
      
      const VIDEO_FORO = "https://www.youtube.com/watch?v=BBBBBBBB"; // ‚Üê reemplaza con tu enlace real

      const VIDEO_PERFIL = "https://www.youtube.com/watch?v=BBBBBBBB";

      // Imagen opcional para respuestas (s√∫bela a Moodle y pega el URL p√∫blico)
      const IMG_CALENDARIO = "https://scontent.fsal2-2.fna.fbcdn.net/v/t39.30808-6/484553841_9387352094687408_6800608587075683597_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=833d8c&_nc_ohc=w4laWYBlHcEQ7kNvwF4HyrB&_nc_oc=Adm2MqO6s8jhnkX06a8gDTY_cvQaumGmd7jfEFY3ZtMydrcFUj-cOQ2X9hq_RJo55vs0pGzwhAI3QBgueSTS-Yss&_nc_zt=23&_nc_ht=scontent.fsal2-2.fna&_nc_gid=MsiTGgaZaTuUwqOpHQIdAA&oh=00_AfUBHRD8F1QfV2Cpd-3IdwY0RNoGb-aL9S5BknwstCpbdg&oe=68A0B739 "; // deja "" si no quieres imagen



      // Sugerencias contextuales seg√∫n el intent respondido
      const SUGGESTIONS = {
        video_matriculacion: [
          { label: "Ver calendario", q: "¬øCu√°ndo inicia y cu√°ndo termina el ciclo 02-2025?" },
          { label: "Crear P√°gina",   q: "¬øC√≥mo crear una P√°gina en Moodle 5?" },
          { label: "Contacto TAC",   q: "¬øC√≥mo puedo contactar a la Unidad?" }
        ],
        proyecto: [
          { label: "Beneficios", q: "¬øCu√°les son los beneficios para estudiantes y docentes?" },
          { label: "Objetivo",   q: "¬øCu√°l es el objetivo principal?" },
          { label: "Documentos", q: "¬øPuedes mostrarme los documentos que tienes a disposici√≥n?" }
        ],
        calendario_academico: [
          { label: "1ros parciales", q: "¬øCu√°ndo son los primeros parciales?" },
          { label: "2dos parciales", q: "¬øCu√°ndo son los segundos parciales?" },
          { label: "Finales",        q: "¬øCu√°ndo son los ex√°menes finales?" }
        ],
        crear_pagina: [
          { label: "Crear Tarea", q: "¬øC√≥mo crear una Tarea en Moodle 5?" },
          { label: "Crear Foro",  q: "¬øC√≥mo crear un Foro en Moodle 5?" },
          { label: "Perfil Docente", q: "¬øC√≥mo configurar mi perfil como docente?" }
        ],
        crear_tarea: [
          { label: "Crear Foro",  q: "¬øC√≥mo crear un Foro en Moodle 5?" },
          { label: "Crear P√°gina",q: "¬øC√≥mo crear una P√°gina en Moodle 5?" }
        ],
        crear_foro: [
          { label: "Crear Tarea", q: "¬øC√≥mo crear una Tarea en Moodle 5?" },
          { label: "Crear P√°gina",q: "¬øC√≥mo crear una P√°gina en Moodle 5?" }
        ],
        configurar_perfil_docente: [
          { label: "Crear P√°gina", q: "¬øC√≥mo crear una P√°gina en Moodle 5?" },
          { label: "Contacto TAC", q: "¬øC√≥mo puedo contactar a la Unidad?" }
        ]
      };


      // Im√°genes por intenci√≥n (solo se inyectan si hay URL)
      const MEDIA = {
        calendario_academico: { img: IMG_CALENDARIO, alt: "Calendario acad√©mico 02-2025" }
        // Ejemplos futuros:
        // crear_tarea: { img: IMG_TAREA, alt: "Flujo para crear Tarea" },
        // crear_foro:  { img: IMG_FORO,  alt: "Tipos de foro en Moodle" }
      };


      // --- intenciones ---
      const INTENTS = [{
        // --- PARA CLAVE DE MATRICULACION ---
        id: "video_matriculacion",
        patterns: [
          /matriculaci(o|on|√≥n)/,
          /(clave|contrasena|contrase√±a).*(matricul)/,
          /ayuda.*(matricul|clave)/,
          /video.*matricul/,
          /tutorial.*matricul/
        ],
       answer: `
          <div class="respuesta-bloque">
            <b>Configurar clave de matriculaci√≥n en Moodle 5:</b>
            <ol>
              <li>Entra al curso y abre <b>Ajustes del curso</b> (engrane superior).</li>
              <li>Ve a <b>Usuarios ‚Üí M√©todos de matriculaci√≥n</b>.</li>
              <li>Activa <b>Auto-matriculaci√≥n (Estudiante)</b>.</li>
              <li>Haz clic en el engrane, escribe la clave y guarda.</li>
            </ol>
            <div class="boton-video">
              <a href="${VIDEO_MATRICULACION}" target="_blank" rel="noopener">
                üé• Ver video tutorial
              </a>
            </div>
          </div>
`
    },
          // --- PARA CREAR UNA PAGINA ---
          {
            id: "crear_pagina",
            patterns: [
              /crear.*pagina/,
              /configurar.*pagina/,
              /recurso.*pagina/,
              /como.*(crear|configurar).*pagina/,
              /pagina.*moodle/,
              /\bpage\b/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Crear una P√°gina en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Activa <b>Edici√≥n</b> en el curso.</li>
                  <li>Haz clic en <b>A√±adir una actividad o un recurso</b> ‚Üí <b>P√°gina</b>.</li>
                  <li>Completa <b>Nombre</b> y el <b>Contenido</b> (puedes usar <i>C√≥digo fuente</i> para HTML).</li>
                  <li>(Opcional) Ajusta <b>Restricciones</b> y <b>Finalizaci√≥n</b>.</li>
                  <li>Pulsa <b>Guardar y mostrar</b>.</li>
                </ol>
                 <div class="boton-video">
                  <a href="${VIDEO_PAGINA}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#1f57b6;color:#fff;text-decoration:none;font-weight:600;">
                    üé• Ver video: crear P√°gina
                  </a>
                </div>
              </div>
            `
          },
          // --- PARA CREAR UNA TAREA---
          {
            id: "crear_tarea",
            patterns: [
              /crear.*tarea/,
              /configurar.*tarea/,
              /actividad.*tarea/,
              /como.*(crear|configurar).*tarea/,
              /tarea.*moodle/,
              /assignment/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Crear una Tarea en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Activa <b>Edici√≥n</b> en el curso.</li>
                  <li>Ve a <b>A√±adir una actividad o un recurso</b> ‚Üí <b>Tarea</b>.</li>
                  <li>Completa <b>Nombre</b> y <b>Descripci√≥n</b>.</li>
                  <li>En <b>Disponibilidad</b>: define apertura, entrega y fecha l√≠mite.</li>
                  <li>En <b>Tipos de entrega</b>: archivos, texto en l√≠nea o ambos.</li>
                  <li>Ajusta <b>Calificaci√≥n</b> y dem√°s opciones si hace falta.</li>
                  <li>Pulsa <b>Guardar y mostrar</b>.</li>
                </ol>
                <div class="boton-video">
                  <a href="${VIDEO_TAREA}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#1f57b6;color:#fff;text-decoration:none;font-weight:600;">
                    üé• Ver video: crear Tarea
                  </a>
                </div>
              </div>
            `
          },
          // --- PARA CREAR UN FORO---
          {
            id: "crear_foro",
            patterns: [
              /crear.*foro/,
              /configurar.*foro/,
              /foro.*moodle/,
              /como.*(crear|configurar).*foro/,
              /forum/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Crear un Foro en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Activa <b>Edici√≥n</b> en el curso.</li>
                  <li>Ve a <b>A√±adir una actividad o un recurso</b> ‚Üí <b>Foro</b>.</li>
                  <li>Completa <b>Nombre</b> y <b>Descripci√≥n</b>.</li>
                  <li>Elige <b>Tipo de foro</b> (est√°ndar, P&amp;R, etc.).</li>
                  <li>(Opcional) Ajusta <b>Suscripci√≥n</b> y <b>Calificaci√≥n</b>.</li>
                  <li>Pulsa <b>Guardar y mostrar</b>.</li>
                </ol>
               <div class="boton-video">
                  <a href="${VIDEO_FORO}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#1f57b6;color:#fff;text-decoration:none;font-weight:600;">
                    üé• Ver video: crear Foro
                  </a>
                </div>
              </div>
            `
          },
          // --- PARA Configurar el perfil---
          {
            id: "configurar_perfil_docente",
            patterns: [
              /configurar mi perfil/,
              /editar perfil profesor/,
              /actualizar perfil/,
              /cambiar foto perfil/,
              /perfil catedratico/,
              /perfil docente/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Configurar tu perfil como docente en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Inicia sesi√≥n en Moodle.</li>
                  <li>Haz clic en tu nombre o foto (arriba a la derecha).</li>
                  <li>Selecciona <b>Perfil</b> y luego <b>Editar perfil</b>.</li>
                  <li>Actualiza tu informaci√≥n y sube una foto si deseas.</li>
                  <li>Haz clic en <b>Actualizar informaci√≥n personal</b> para guardar.</li>
                </ol>
                <div class="boton-video">
                  <a href="${VIDEO_PERFIL}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#007bff;color:#fff;text-decoration:none;font-weight:600;">
                    Ver video tutorial
                  </a>
                </div>
              </div>
            `
          },

          {
          id: "presentacion",
          patterns: [/presentar(te)?/, /presentacion/, /hola/],
          answer: `
        <b>¬°Hola!</b> Soy el <b>Chatbot TAC</b>, un prototipo desarrollado por la Unidad TAC
        para mostrar c√≥mo la <b>inteligencia artificial</b> puede apoyar a docentes y estudiantes.
        Estoy aqu√≠ para responder preguntas sobre el proyecto, la Unidad TAC y darte una idea
        de c√≥mo funcionar√≠a un asistente virtual integrado en todos los cursos.
      `
        },
        {
          id: "bienvenida",
          patterns: [/bienvenid(a|o)?/, /dar la bienvenida/],
          answer: `
        <b>¬°Bienvenido/a al entorno de prueba del Chatbot TAC!</b><br>
        Aqu√≠ puedes interactuar conmigo para conocer m√°s sobre:
        <ul>
          <li>El <b>proyecto de chatbots</b> en la universidad.</li>
          <li>La <b>Unidad TAC</b> y sus funciones.</li>
          <li>Informaci√≥n acad√©mica y de soporte.</li>
        </ul>
        Esta es una demostraci√≥n; en la versi√≥n final estar√© integrado al curso
        con acceso a tus recursos y actividades.
      `
        },
        {
          id: "proyecto",
          patterns: [/proyecto/, /en que consiste/,
            /consiste el nuevo proyecto/
          ],
          answer: `
        El <b>proyecto de chatbots educativos</b> de la Unidad TAC busca incorporar asistentes virtuales en los cursos para:
        <ul>
          <li>Brindar <b>respuestas inmediatas</b> a dudas frecuentes.</li>
          <li>Apoyar a los docentes en <b>gesti√≥n y comunicaci√≥n</b>.</li>
          <li>Mejorar la <b>experiencia de aprendizaje</b> de los estudiantes.</li>
        </ul>
        Esta prueba es solo una muestra de lo que se puede lograr.
      `
        },
        {
          id: "objetivo",
          patterns: [/objetivo(s)?/, /meta principal/],
          answer: `
        El objetivo principal es que <b>cada curso</b> cuente con un asistente virtual
        disponible <b>24/7</b> que pueda responder preguntas, dar recordatorios
        y facilitar la navegaci√≥n por la plataforma.
      `
        },
        {
          id: "beneficios",
          patterns: [/beneficio(s)?/, /ventaja(s)?/],
          answer: `
        <b>Beneficios esperados:</b>
        <ul>
          <li>Ahorro de tiempo para docentes y estudiantes.</li>
          <li>Atenci√≥n inmediata en cualquier momento.</li>
          <li>Informaci√≥n consistente y actualizada.</li>
        </ul>
      `
        },
        {
          id: "unidad_tac",
          patterns: [/unidad tac/, /que es la unidad tac/,
            /tecnologias del aprendizaje/
          ],
          answer: `
        La <b>Unidad de Tecnolog√≠as del Aprendizaje y el Conocimiento (TAC)</b> impulsa la
        integraci√≥n de herramientas digitales en la docencia, brindando soporte, capacitaci√≥n
        y asesor√≠a en innovaci√≥n educativa.
      `
        },
        {
          id: "funcion_tac",
          patterns: [/funcion de la unidad/, /rol(es)? tac/,
            /que hace la unidad tac/
          ],
          answer: `
        <b>Funciones principales de la Unidad TAC:</b>
        <ul>
          <li>Capacitaci√≥n docente en uso de tecnolog√≠a educativa.</li>
          <li>Soporte t√©cnico sobre plataformas.</li>
          <li>Asesor√≠a en dise√±o de cursos virtuales.</li>
        </ul>
      `
        },
        {
          id: "historia_tac",
          patterns: [/historia tac/, /cuando se creo/,
            /desde cuando existe/
          ],
          answer: `
        La Unidad TAC fue creada para modernizar la ense√±anza universitaria mediante
        la adopci√≥n de tecnolog√≠as. Desde su fundaci√≥n ha liderado iniciativas de
        innovaci√≥n y formaci√≥n digital.
      `
        },
        {
          id: "ubicacion_tac",
          patterns: [/como puedo llegar/, /donde (estan|se encuentra)/],
          answer: `
        <b>Ubicaci√≥n:</b> Edificio Central, piso 3, oficina 305.
      `
        },
        {
          id: "contacto_tac",
          patterns: [/contacto/,/contactar/, /contactar a la unidad/,/correo/, /telefono/, /comunicarme/],
          answer: `
        <b>Contacto Unidad TAC:</b><br>
        üìß tac@universidad.edu<br>
        üìû (+504) 1234-5678<br>
        Horario: lunes a viernes, 8:00‚Äì17:00.
      `
        },
        {
          id: "servicios_tac",
          patterns: [/servicio(s)?/, /ofrece la unidad tac/, /que brindan/],
          answer: `
        <b>Servicios de la Unidad TAC:</b>
        <ul>
          <li>Capacitaci√≥n en plataformas virtuales.</li>
          <li>Soporte t√©cnico y resoluci√≥n de problemas.</li>
          <li>Asesor√≠a en dise√±o instruccional y multimedia.</li>
        </ul>
      `
        },
        {
          id: "futuro",
          patterns: [/futuro/, /vision/],
          answer: `
        En el futuro se busca integrar chatbots en todos los cursos,
        conectados a datos reales y con capacidad de dar asistencia
        personalizada a cada estudiante y docente.
      `
        },
        {
          id: "documentos",
          patterns: [/documento(s)?/, /manual/, /guia/],
          answer: `
        üìÑ <a href="#" target="_blank">Documento del Proyecto</a><br>
        üìÑ <a href="#" target="_blank">Manual de Uso del Chatbot</a>
      `
        },
        {
          id: "calendario_academico",
          patterns: [/calendario/, /fechas importantes/, /cuando inicia/,
            /cuando termina/
          ],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìÖ Inicio de clases: <b>14 de julio</b></li>
          <li>üìÖ Finalizaci√≥n: <b>29 de noviembre</b></li>
          <li>üìù Primeros parciales: <b>1 al 6 de septiembre</b></li>
          <li>üìù Segundos parciales: <b>20 al 25 de octubre</b></li>
          <li>üìö Ex√°menes finales: <b>2 al 8 de diciembre</b></li>
        </ul>
      `
        },
        {
          id: "calendario_academico2",
          patterns: [/primeros parciales/],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìù Primeros parciales: <b>1 al 6 de septiembre</b></li>
        </ul>
      `
        },

        {
          id: "calendario_academico3",
          patterns: [/segundos parciales/],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìù Segundos parciales: <b>20 al 25 de octubre</b></li>
        </ul>
      `
        },
        {
          id: "calendario_academico4",
          patterns: [/examenes finales/],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìö Ex√°menes finales: <b>2 al 8 de diciembre</b></li>
        </ul>
      `
        },
        {
          id: "politicas_evaluacion",
          patterns: [/politica(s)?/, /evaluacion/, /reglas/],
          answer: `
        <b>Pol√≠ticas de evaluaci√≥n:</b>
        <ol>
          <li>Solo los alumnos matriculados correctamente en NetCampus podr√°n evaluarse.</li>
          <li>Se requiere al menos un <b>80% de asistencia</b> para tener derecho a examen final.</li>
        </ol>
      `
        },
        {
          id: "soporte_plataformas",
          patterns: [/soporte plataforma/, /ayuda plataforma/,
            /problema en netcampus/
          ],
          answer: `
        <b>Soporte de plataformas:</b>
        <ol>
          <li>Verifica tu conexi√≥n a internet y actualiza la p√°gina.</li>
          <li>Consulta la secci√≥n de <b>Preguntas Frecuentes</b> en NetCampus.</li>
          <li>Si el problema persiste, env√≠a un correo a <i>soporte@universidad.edu</i> con captura de pantalla y descripci√≥n.</li>
          <li>Horario de atenci√≥n: lunes a viernes, 8:00‚Äì17:00.</li>
        </ol>
      `
        },
        {
          id: "dato_curioso",
          patterns: [/dato curioso/, /curiosidad/],
          answer: `
        ¬øSab√≠as que el primer curso en l√≠nea de la universidad se imparti√≥ en <b>2008</b>?
        Desde entonces, se han desarrollado m√°s de 300 cursos virtuales.
      `
        },
        {
          id: "frase",
          patterns: [/frase motivadora/, /motivacion/, /inspir(a|acion)/],
          answer: `
        ‚Äú<i>El aprendizaje es un viaje continuo; cada pregunta es un paso hacia adelante.</i>‚Äù
      `
        },
        {
          id: "chiste",
          patterns: [/chiste/, /broma/],
          answer: `
        ‚Äî ¬øPor qu√© el estudiante llev√≥ una escalera a clase?<br>
        ‚Äî ¬°Porque quer√≠a llegar al nivel superior! üòÑ
      `
        },
        {
          id: "gracias",
          patterns: [/gracias/],
          answer: `
        De nada, consultame cuando quieras! estoy aqu√≠ para ayudar üòÑ<br>
      `
        },
        {
          id: "despedida",
          patterns: [/bye/, /adios/, /hasta luego/, /gracias/, /nos vemos/],
          answer: `
               ¬°Fue un gusto conversar contigo! üòä<br>
              Recuerda que la <b>Unidad TAC</b> siempre est√° aqu√≠ para apoyarte en tu aprendizaje y en el uso de NetCampus.<br>
               ¬°Te esperamos pronto para seguir innovando juntos! üöÄ
    `
        },
        
        // -- Aqu√≠ comienzan las preguntas propuestas por Melvin  ---
        // ===============================
        // INTENTS NUEVOS (Docentes)
        // ===============================
        // 1) Activar automatriculaci√≥n en un curso
      {
        id: "prof_auto_matriculacion_activar",
        patterns: [
          /activar.*auto.*matricul/,
          /habilitar.*auto.*inscrip/,
          /inscripci(o|√≥)n.*autom(a|√°)tica/,
          /metodos.*inscrip.*auto/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Activar la automatriculaci√≥n en tu curso:</b>
            <ol>
              <li>Entra al curso y abre <b>Participantes</b>.</li>
              <li>En el men√∫ de <b>Participantes</b>, elige <b>M√©todos de inscripci√≥n</b>.</li>
              <li>Localiza <b>Automatriculaci√≥n (estudiante)</b> y haz clic en el <b>√≠cono de ojo</b> para activarla.</li>
              <li>Haz clic en el <b>engrane</b> para configurar: clave de inscripci√≥n (opcional), duraci√≥n de matr√≠cula, l√≠mites y mensaje de bienvenida.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // 2) Matricular usuarios manualmente
      {
        id: "prof_matricular_manual",
        patterns: [
          /matricular.*manual/,
          /inscribir.*manual/,
          /agregar.*usuario.*curso/,
          /anadir.*participante/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Matricular usuarios manualmente:</b>
            <ol>
              <li>Entra al curso ‚Üí <b>Participantes</b> ‚Üí <b>M√©todos de inscripci√≥n</b>.</li>
              <li>Verifica que <b>Matr√≠cula manual</b> est√° <b>activa</b> (ojo abierto).</li>
              <li>Haz clic en <b>Matricular usuarios</b> y busca a las personas.</li>
              <li>Asigna el <b>rol</b> (p. ej., Estudiante) y, si quieres, define <b>fecha/duraci√≥n</b> de matr√≠cula.</li>
              <li>Confirma con <b>Matricular usuarios seleccionados</b>.</li>
            </ol>
          </div>
        `
      },

      // 3) A√±adir la descripci√≥n del curso (duplicado en doc, consolidado)
      {
        id: "prof_descripcion_curso",
        patterns: [
          /descripcion.*curso/,
          /resumen.*curso/,
          /presentacion.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>A√±adir/editar la descripci√≥n del curso:</b>
            <ol>
              <li>Entra al curso y abre <b>Configuraci√≥n del curso</b>.</li>
              <li>En <b>General</b>, edita el campo <b>Descripci√≥n</b> con objetivos, contenidos y metodolog√≠a.</li>
              <li>(Opcional) Adjunta <b>im√°genes/archivos</b> de apoyo.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // 4) Entregar tareas (perspectiva estudiante, √∫til para docentes al dar indicaciones)
      {
        id: "alumno_entregar_tarea_20mb",
        patterns: [
          /entregar.*tarea/,
          /subir.*tarea/,
          /enviar.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>C√≥mo entregar una tarea (l√≠mite t√≠pico 20&nbsp;MB):</b>
            <ol>
              <li>Abre la actividad <b>Tarea</b> y lee las <b>instrucciones</b> y <b>fecha l√≠mite</b>.</li>
              <li>Haz clic en <b>Agregar entrega</b>.</li>
              <li>Adjunta tu archivo (respeta el <b>tama√±o m√°ximo</b> indicado).</li>
              <li>Haz clic en <b>Guardar cambios</b> y, si corresponde, <b>Enviar tarea</b> para confirmar.</li>
            </ol>
          </div>
        `
      },

      // 5) Resolver cuestionarios (estudiante)
      {
        id: "alumno_resolver_cuestionario",
        patterns: [
          /resolver.*cuestionario/,
          /rendir.*examen.*virtual/,
          /intentar.*cuestionario/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>C√≥mo resolver un cuestionario:</b>
            <ol>
              <li>Abre el <b>cuestionario</b> y revisa <b>apertura</b>, <b>l√≠mite de tiempo</b> e <b>intentos</b>.</li>
              <li>Haz clic en <b>Intentar resolver ahora</b>.</li>
              <li>Responde cada pregunta (opci√≥n m√∫ltiple, V/F, ensayo, etc.).</li>
              <li>Selecciona <b>Finalizar intento</b> y revisa tus respuestas.</li>
              <li>Confirma con <b>Enviar todo y terminar</b>.</li>
            </ol>
          </div>
        `
      },

      // 6) Configurar la calificaci√≥n del curso (libro de calificaciones)
      {
        id: "prof_calificaciones_configurar",
        patterns: [
          /configurar.*calificaci(o|√≥)n.*curso/,
          /ajust(es|ar).*libro.*calific/,
          /peso.*actividades.*calific/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Configurar el libro de calificaciones:</b>
            <ol>
              <li>Entra al curso ‚Üí <b>Calificaciones</b> ‚Üí <b>Ajustes del libro</b>/<b>Configuraci√≥n del curso</b>.</li>
              <li>Crea <b>categor√≠as</b> (p. ej., Ex√°menes, Tareas, Participaci√≥n).</li>
              <li>Define el <b>m√©todo de c√°lculo</b> (suma, media ponderada, etc.) y los <b>pesos</b>.</li>
              <li>Coloca cada actividad en su <b>categor√≠a</b> y verifica el <b>c√°lculo final</b>.</li>
              <li>Guarda los cambios y revisa el <b>Informe del calificador</b>.</li>
            </ol>
          </div>
        `
      },

      // 7) Crear una tarea (si ya existe, puedes unificar/actualizar el intent actual).
      //  Descripci√≥n: ESTA TIENE CONFLICTO con el intent "crear_tarea" de arriba, que es para estudiantes.
      {
        id: "prof_crear_tarea_pasoapaso",
        patterns: [
          /crear.*tarea.*docente/,
          /configurar.*tarea.*docente/,
          /actividad.*tarea.*docente/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear una tarea (docente):</b>
            <ol>
              <li>Activa la <b>edici√≥n</b> en el curso.</li>
              <li><b>A√±adir una actividad o un recurso</b> ‚Üí <b>Tarea</b>.</li>
              <li>Define <b>Nombre</b>, <b>Descripci√≥n</b> e <b>instrucciones</b>.</li>
              <li>Configura <b>fechas</b> (desde, entrega, l√≠mite) y <b>tama√±o m√°x. de archivo</b>.</li>
              <li>Ajusta <b>Calificaci√≥n</b> (puntuaci√≥n y categor√≠a) y <b>Tipos de entrega</b> (archivo/texto).</li>
              <li>Guarda con <b>Guardar y mostrar</b>.</li>
            </ol>
          </div>
        `
      },

      // 8) Foro: preguntas generadoras y configuraci√≥n b√°sica
      // CORREGIDO: Patrones m√°s flexibles para mejor coincidencia
      {
        id: "prof_foro_preguntas_generadoras",
        patterns: [
          /preguntas.*generadoras/,
          /foro.*preguntas/,
          /crear.*foro/,
          /foro.*debate/,
          /configurar.*foro/,
          /foro.*discusion/,
          /foro.*discusi√≥n/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear un foro con preguntas generadoras:</b>
            <ol>
              <li>Activa la <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Foro</b>.</li>
              <li>Escribe <b>Nombre</b> y <b>Descripci√≥n</b> (instrucciones, reglas y tus preguntas generadoras).</li>
              <li>Elige <b>Tipo</b>: <i>Debate sencillo</i> para un √∫nico tema.</li>
              <li>Define <b>Disponibilidad</b> (fecha de entrega y fecha l√≠mite si requieres cierre).</li>
              <li>En <b>Adjuntos</b>, fija cantidad y tama√±o, y habilita el <b>recuento de palabras</b> si lo necesitas.</li>
              <li>En <b>Suscripci√≥n</b>, usa <i>forzosa</i> si quieres asegurar la participaci√≥n.</li>
              <li>En <b>Evaluaci√≥n</b>, asigna <b>Escala</b> o <b>puntos</b> seg√∫n tu r√∫brica.</li>
              <li><b>Guardar cambios y regresar al curso</b>.</li>
            </ol>
          </div>
        `
      },

      // 9) Reutilizaci√≥n/Importaci√≥n de cursos
      {
        id: "prof_reutilizacion_importacion",
        patterns: [
          /reutilizaci(o|√≥)n.*curso/,
          /importar.*curso/,
          /copiar.*contenido.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Importar (reutilizar) contenido de otro curso:</b>
            <ol>
              <li>Abre <b>dos ventanas</b>: curso origen (viejo) y curso destino (vac√≠o).</li>
              <li>En el curso destino: <b>M√°s</b> ‚Üí <b>Reutilizaci√≥n de curso</b> ‚Üí <b>Importar</b>.</li>
              <li>Busca el curso origen por <b>c√≥digo</b> (p. ej., <i>ADM-3200-01</i>) y selecci√≥nalo.</li>
              <li>Elige qu√© <b>elementos copiar</b> (desmarca lo que no quieres: enlaces de Teams/WhatsApp, etc.).</li>
              <li>Revisa el resumen (verde = se copiar√°) y confirma con <b>Realizar la importaci√≥n</b>.</li>
            </ol>
          </div>
        `
      },

      // 10) Crear actividad H5P
      {
        id: "prof_crear_h5p",
        patterns: [
          /crear.*h5p/,
          /contenido.*interactivo.*h5p/,
          /agregar.*h5p/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear una actividad H5P:</b>
            <ol>
              <li>Activa <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Contenido interactivo H5P</b>.</li>
              <li>Asigna un <b>nombre</b> y crea el contenido en el <b>editor H5P</b> o <b>sube</b> un archivo .h5p.</li>
              <li>Configura <b>calificaci√≥n</b>, <b>intentos</b> y <b>restricciones de acceso</b>.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // 11) Reiniciar curso (reset)
      {
        id: "prof_reiniciar_curso",
        patterns: [
          /reiniciar.*curso/,
          /reset.*curso/,
          /revitalizar.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Reiniciar un curso para un nuevo ciclo:</b>
            <ol>
              <li>En el curso: <b>M√°s</b> ‚Üí <b>Reutilizaci√≥n de curso</b> ‚Üí <b>Reiniciar curso</b>.</li>
              <li>Elige qu√© <b>reiniciar</b>: calificaciones, actividades, usuarios, foros, etc.</li>
              <li>Confirma. El curso queda limpio para el nuevo ciclo, <b>manteniendo la estructura</b>.</li>
            </ol>
          </div>
        `
      },

      // 12) Dise√±ar y aplicar cuestionarios (resumen docente)
      {
        id: "prof_diseniar_aplicar_cuestionarios",
        patterns: [
          /disenar.*cuestionario/,
          /aplicar.*cuestionario/,
          /configurar.*examen.*moodle/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Dise√±ar y aplicar un cuestionario:</b>
            <ol>
              <li>Activa <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Cuestionario</b>.</li>
              <li>Define <b>nombre</b>, <b>descripci√≥n</b>, <b>tiempos</b> e <b>intentos</b>.</li>
              <li>Agrega preguntas nuevas o desde el <b>banco de preguntas</b>.</li>
              <li>Configura <b>calificaci√≥n</b> (p. ej., calificaci√≥n m√°s alta o promedio).</li>
              <li>Publica. Los estudiantes podr√°n responder seg√∫n las fechas establecidas.</li>
            </ol>
          </div>
        `
      },

      // 13) Filtrar entregas (calificadas/pendientes) en Tarea
      {
        id: "prof_filtrar_entregas_tarea",
        patterns: [
          /filtrar.*entregas/,
          /ver.*entregas.*calificadas/,
          /pendientes.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Filtrar entregas en una Tarea:</b>
            <ol>
              <li>Abre la <b>Tarea</b> ‚Üí <b>Ver todas las entregas</b>.</li>
              <li>Usa los <b>filtros</b> para mostrar: <i>calificadas</i>, <i>pendientes</i>, <i>con retraso</i>.</li>
              <li>Gestiona y revisa m√°s r√°pido lo que necesitas evaluar.</li>
            </ol>
          </div>
        `
      },

      // 14) Penalizaciones por entregas tard√≠as
      {
        id: "prof_penalizacion_retraso",
        patterns: [
          /penalizaci(o|√≥)n.*tard[i√≠]as/,
          /descuento.*entrega.*tarde/,
          /fecha.*limite.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Configurar penalizaci√≥n por entrega tard√≠a:</b>
            <ol>
              <li>En la <b>Tarea</b>, edita la actividad.</li>
              <li>Activa <b>Fecha l√≠mite</b> y establece la pol√≠tica de <b>penalizaci√≥n</b> (si tu configuraci√≥n la ofrece) o define el manejo de <b>env√≠os fuera de plazo</b>.</li>
              <li>Guarda y prueba con un usuario de ejemplo para validar el flujo.</li>
            </ol>
          </div>
        `
      },

      // 15) Crear cuestionario paso a paso (detalle)
      {
        id: "prof_crear_cuestionario_pasoapaso",
        patterns: [
          /crear.*cuestionario/,
          /nuevo.*cuestionario/,
          /configurar.*cuestionario/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear un cuestionario (paso a paso):</b>
            <ol>
              <li>Activa <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Cuestionario</b> ‚Üí <b>Agregar</b>.</li>
              <li>Completa <b>Nombre</b> y <b>Descripci√≥n</b> (instrucciones claras para estudiantes).</li>
              <li>Define <b>apertura/cierre</b>, <b>tiempo l√≠mite</b> e <b>intentos permitidos</b>.</li>
              <li>Configura <b>calificaci√≥n</b> (puntaje m√°ximo, m√©todo de agregaci√≥n de intentos).</li>
              <li>Guarda y luego entra a <b>Editar cuestionario</b> para agregar preguntas (nuevas o del banco).</li>
              <li>Ordena preguntas y ajusta la <b>puntuaci√≥n</b> de cada una ‚Üí <b>Guardar</b> y publicar.</li>
            </ol>
          </div>
        `
      },

      // 16) Pre-crear/simular intentos (seg√∫n disponibilidad)
      {
        id: "prof_precrear_intentos",
        patterns: [
          /pre.*crear.*intentos.*cuestionario/,
          /simular.*intentos/,
          /probar.*cuestionario.*docente/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Probar un cuestionario antes de publicarlo:</b>
            <ol>
              <li>Abre el <b>cuestionario</b> ya configurado.</li>
              <li>Usa <b>Vista previa</b> para simular un intento y verificar tiempos, navegaci√≥n y retroalimentaci√≥n.</li>
              <li>En <b>Configuraci√≥n ‚Üí Calificaci√≥n</b>, ajusta <b>intentos permitidos</b> si necesitas m√∫ltiples ejecuciones.</li>
              <li>(Opcional) Prueba con una <b>cuenta de estudiante de prueba</b> para ver el flujo real.</li>
            </ol>
            <div style="font-size:.95em;opacity:.85">Nota: Algunas instalaciones incluyen opciones avanzadas de simulaci√≥n; si no las ves, usa Vista previa.</div>
          </div>
        `
      },

      // 17) Gestionar banco de preguntas
      {
        id: "prof_banco_preguntas_gestion",
        patterns: [
          /banco.*preguntas/,
          /gestionar.*preguntas.*cuestionario/,
          /importar.*exportar.*preguntas/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Gestionar el banco de preguntas:</b>
            <ol>
              <li>Ve a <b>Banco de preguntas</b> ‚Üí <b>Preguntas</b>.</li>
              <li><b>Crear:</b> <i>Agregar</i> ‚Üí tipo (opci√≥n m√∫ltiple, V/F, etc.), redacta enunciado, respuestas y calificaci√≥n ‚Üí <b>Guardar</b>.</li>
              <li><b>Duplicar:</b> selecciona la pregunta ‚Üí <b>Duplicar</b> ‚Üí ajusta y guarda.</li>
              <li><b>Filtrar:</b> por <b>categor√≠a</b>, <b>tipo</b> o <b>palabras clave</b> para encontrar m√°s r√°pido.</li>
              <li><b>Compartir:</b> <i>Exportar</i> (Moodle XML, GIFT) para usar en otros cursos; <i>Importar</i> para traer bancos externos.</li>
            </ol>
          </div>
        `
      },

      // 18) Accesibilidad: descripciones en im√°genes
      {
        id: "prof_accesibilidad_descripcion_imagen",
        patterns: [
          /accesibilidad.*imagen/,
          /descripcion.*larga.*imagen/,
          /texto.*alternativo.*imagen/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Accesibilidad en im√°genes (alt y descripci√≥n larga):</b>
            <ol>
              <li>En el editor, inserta o selecciona la <b>imagen</b>.</li>
              <li>Abre <b>Propiedades de la imagen</b> ‚Üí completa <b>Texto alternativo</b> (breve y descriptivo).</li>
              <li>Si necesitas m√°s detalle, agrega <b>Descripci√≥n larga</b> (Long description) con contexto y prop√≥sito.</li>
              <li>Guarda y verifica con un <b>lector de pantalla</b> si es posible.</li>
            </ol>
          </div>
        `
      },

      // 19) Plantillas de respaldo (backup)
      {
        id: "prof_plantillas_respaldo",
        patterns: [
          /plantilla.*respaldo/,
          /copia.*seguridad.*curso/,
          /backup.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear y usar plantillas de respaldo:</b>
            <ol>
              <li>En el curso: <b>M√°s</b> ‚Üí <b>Reutilizaci√≥n de curso</b> ‚Üí <b>Copia de seguridad</b>.</li>
              <li>Selecciona qu√© incluir: <b>actividades</b>, <b>bloques</b>, <b>calificaciones</b>, <b>usuarios</b>, etc.</li>
              <li>Guarda la <b>plantilla</b> con un nombre claro (p. ej., ‚ÄúRespaldo-base-sin-usuarios‚Äù).</li>
              <li>Reutiliza esa plantilla para crear <b>backups consistentes y r√°pidos</b>.</li>
            </ol>
          </div>
        `
      },

      // 20) EXTRA: Exportar calificaciones
      {
        id: "prof_exportar_calificaciones",
        patterns: [
          /exportar.*calificaci/,
          /descargar.*calificaci/,
          /informe.*calificador.*exportar/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Exportar calificaciones del curso:</b>
            <ol>
              <li>Entra a <b>Calificaciones</b> ‚Üí <b>Exportar</b>.</li>
              <li>Elige formato (CSV, XLSX, etc.) y <b>rango de √≠tems</b>.</li>
              <li>Configura separadores/encabezados si usas CSV.</li>
              <li>Haz clic en <b>Descargar</b> y verifica el archivo.</li>
            </ol>
          </div>
        `
      },

      // 21) EXTRA: Mostrar/Ocultar curso para estudiantes
      {
        id: "prof_mostrar_ocultar_curso",
        patterns: [
          /ocultar.*curso/,
          /mostrar.*curso/,
          /disponibilidad.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Ocultar o mostrar el curso a estudiantes:</b>
            <ol>
              <li>Abre <b>Configuraci√≥n del curso</b>.</li>
              <li>En <b>Visibilidad del curso</b>, elige <b>Ocultar</b> o <b>Mostrar</b>.</li>
              <li>Guarda. <span style="opacity:.85">√ötil antes del inicio o para mantenimiento.</span></li>
            </ol>
          </div>
        `
      },

      // 22) EXTRA: Ajustar tama√±o m√°ximo de archivo en Tarea
      {
        id: "prof_tarea_tamano_archivo",
        patterns: [
          /tam(a|√°)no.*archivo.*tarea/,
          /limite.*mb.*tarea/,
          /peso.*archivo.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Cambiar el tama√±o m√°ximo de archivo en una Tarea:</b>
            <ol>
              <li>Editar la <b>Tarea</b> ‚Üí secci√≥n <b>Tipos de entrega</b>.</li>
              <li>Ajusta <b>Tama√±o m√°ximo de env√≠o</b> (p. ej., 20&nbsp;MB).</li>
              <li>Guarda y comunica el l√≠mite a tus estudiantes.</li>
            </ol>
          </div>
        `
      },

      // 23) EXTRA: Reabrir intento o dar intento extra en cuestionario
      {
        id: "prof_cuestionario_intento_extra",
        patterns: [
          /dar.*intento.*extra/,
          /reabrir.*intento.*cuestionario/,
          /permitir.*otro.*intento/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Conceder un intento extra en un cuestionario:</b>
            <ol>
              <li>Abre el <b>cuestionario</b> ‚Üí <b>Intentos</b> / <b>Resultados</b>.</li>
              <li>Localiza al estudiante y usa <b>anulaci√≥n de usuario</b> (override) para cambiar <b>intentos</b> y/o <b>tiempo</b>.</li>
              <li>Guarda. Informa al estudiante para que vuelva a ingresar.</li>
            </ol>
          </div>
        `
      },

      // 24) EXTRA: Permitir reenv√≠o (reapertura) de tarea
      {
        id: "prof_tarea_reenvio",
        patterns: [
          /permitir.*reenv[i√≠]o.*tarea/,
          /reabrir.*tarea/,
          /otro.*env[i√≠]o.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Permitir reenv√≠o de una Tarea:</b>
            <ol>
              <li>Editar la <b>Tarea</b> ‚Üí ajusta <b>Fecha de entrega</b>/<b>Fecha l√≠mite</b> o habilita <b>Requerir que los estudiantes hagan clic en Enviar</b> para controlar estados.</li>
              <li>En <b>Calificaci√≥n</b>, habilita <b>flujo de calificaci√≥n</b> si quieres controlar la liberaci√≥n de notas.</li>
              <li>Guarda y avisa al estudiante que ya puede volver a enviar.</li>
            </ol>
          </div>
        `
      }
      ,

      // Aqui comienzan las preguntas dise√±adas para los estudiantes las que paso Melvin.
      // ---------------------------------------------------------
      // Permite al estudiante editar su perfil (datos b√°sicos).
      // Patrones: verbos comunes (modificar/editar/cambiar) + "perfil".
      // Nota: mantenemos t√©rminos gen√©ricos para capturar variaciones.
      // ---------------------------------------------------------
      {
        id: "alumno_modificar_perfil",
        patterns: [
          /modificar.*perfil/i,
          /editar.*perfil.*estudiante/i,
          /cambiar.*informaci[o√≥]n.*perfil/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Modificar tu perfil en Moodle:</b>
            <ol>
              <li>Inicia sesi√≥n en la plataforma.</li>
              <li>Haz clic en tu nombre o foto (esquina superior derecha).</li>
              <li>Selecciona <b>Perfil</b> y luego <b>Editar perfil</b>.</li>
              <li>Cambia los datos que necesites: nombre, correo, descripci√≥n, idioma, etc.</li>
              <li>Haz clic en <b>Guardar cambios</b> para aplicar la actualizaci√≥n.</li>
            </ol>
          </div>
        `
      },

      // -----------------------------------------------------------------
      // Cambiar/a√±adir foto de perfil.
      // Patrones: "agregar/subir/cambiar" + "foto" + "perfil".
      // Consejo: si tu UI usa compresi√≥n/recorte, podr√≠as enlazar un tip.
      // -----------------------------------------------------------------
      {
        id: "alumno_foto_perfil",
        patterns: [
          /agregar.*foto.*perfil/i,
          /subir.*foto.*perfil/i,
          /cambiar.*foto.*perfil/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>A√±adir o cambiar tu foto de perfil:</b>
            <ol>
              <li>Ve a <b>Perfil ‚Üí Editar perfil</b>.</li>
              <li>En la secci√≥n <b>Imagen del usuario</b>, arrastra tu foto o haz clic en <b>Agregar archivo</b>.</li>
              <li>Sube la imagen y guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // --------------------------------------------------------------------
      // Recuperaci√≥n de contrase√±a (flujo est√°ndar de "olvid√© mi contrase√±a").
      // Patrones: cubrir "recuperar", "olvid√©", "resetear" + (contrase√±a/clave).
      // Nota: incluimos (√±/n) y acentos en regex para robustez b√°sica.
      // --------------------------------------------------------------------
      {
        id: "alumno_recuperar_contrasena",
        patterns: [
          /recuperar.*contrase[n√±]a/i,
          /olvid[e√©].*clave/i,
          /resetear.*clave/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Recuperar tu contrase√±a:</b>
            <ol>
              <li>En la pantalla de inicio, haz clic en <b>¬øOlvid√≥ su nombre de usuario o contrase√±a?</b>.</li>
              <li>Ingresa tu correo o usuario registrado.</li>
              <li>Revisa tu correo y sigue el enlace para crear una nueva clave.</li>
            </ol>
          </div>
        `
      },

      // ----------------------------------------------------------------------
      // Explica qu√© son las "etiquetas" (√°rea de texto y medios) en el curso.
      // Patrones: consultas tipo "¬øqu√© son?" y verbos "usar/insertar".
      // Nota: √∫til para estudiantes curiosos y tambi√©n asistentes de c√°tedra.
      // ----------------------------------------------------------------------
      {
        id: "alumno_etiquetas",
        patterns: [
          /qu[e√©].*son.*etiquetas/i,
          /usar.*etiquetas.*curso/i,
          /insertar.*texto.*imagen.*curso/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Usar etiquetas en un curso:</b>
            <ol>
              <li>Activa la <b>edici√≥n</b> en el curso.</li>
              <li>Haz clic en <b>A√±adir actividad o recurso</b>.</li>
              <li>Selecciona <b>√Årea de texto y medios</b> (etiqueta).</li>
              <li>Escribe el contenido: texto, imagen, video o enlace.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------------
      // Auto-matriculaci√≥n (sin o con clave si el curso la requiere).
      // Patrones: "auto-matricular", "inscripci√≥n autom√°tica", "unirme".
      // Consejo: en tu instancia cambia "Moodle" por "Sinapsis" si aplica.
      // -------------------------------------------------------------

      //Esta tiene conflicto con el intent "matricularme con clave" de arriba.
      // Lo ideal ser√≠a unificar ambos en uno solo, pero como no tengo claro el flujo
      {
        id: "alumno_autoregistro",
        patterns: [
          /auto.*matricul(ar|aci[o√≥]n)/i,
          /inscripci[o√≥]n.*autom[a√°]tica/i,
          /unirme.*curso.*sin.*clave/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Auto-matricularte en un curso:</b>
            <ol>
              <li>Inicia sesi√≥n en Moodle.</li>
              <li>Abre el listado de cursos disponibles.</li>
              <li>Haz clic en el curso que te interese y pulsa <b>Matricularme</b>.</li>
              <li>Si pide clave, introd√∫cela y confirma.</li>
              <li>El curso quedar√° en tu p√°gina principal.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------------------
      // Matriculaci√≥n cuando el curso tiene clave (incluye fuente de claves).
      // Patrones: "matricularme con clave", "acceso con clave", "inscribirme".
      // Nota: personaliza el paso de "d√≥nde ver claves" a tu instituci√≥n.
      // -------------------------------------------------------------------

      //Esta tiene conflicto con el intent "matricularme con clave" de arriba.
      // Lo ideal ser√≠a unificar ambos en uno solo, pero como no tengo claro el flujo
      {
        id: "alumno_matricula_clave",
        patterns: [
          /matricul(ar|aci[o√≥]n).*clave/i,
          /inscribirme.*clave/i,
          /acceso.*curso.*clave/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Matricularte con clave de acceso:</b>
            <ol>
              <li>Inicia sesi√≥n en Moodle.</li>
              <li>Busca el curso y haz clic en √©l.</li>
              <li>Consulta la p√°gina oficial donde publican las <b>claves de acceso</b> por d√≠a.</li>
              <li>Introduce la clave en Moodle y confirma tu matr√≠cula.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------
      // D√≥nde ver las calificaciones del curso (libreta).
      // Patrones: "ver notas/calificaciones".
      // -------------------------------------------------
      {
        id: "alumno_ver_calificaciones",
        patterns: [
          /ver.*calificaciones/i,
          /notas.*curso/i,
          /calificaci[o√≥]n.*tareas/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Ver tus calificaciones:</b>
            <ol>
              <li>Entra al curso.</li>
              <li>Abre el men√∫ lateral y haz clic en <b>Calificaciones</b>.</li>
              <li>Ver√°s tu libreta con tareas, ex√°menes y comentarios del profesor.</li>
            </ol>
          </div>
        `
      },

      // ----------------------------------------------
      // Participaci√≥n en foros (crear y responder).
      // Patrones: "participar/publicar/debate".
      // ----------------------------------------------

      // CORREGIDO: Patrones m√°s flexibles para mejor coincidencia
      {
        id: "alumno_foro_participar",
        patterns: [
          /participar.*foro/i,
          /foro.*participar/i,
          /publicar.*foro/i,
          /foro.*publicar/i,
          /debate.*foro/i,
          /foro.*debate/i,
          /escribir.*foro/i,
          /foro.*escribir/i,
          /mensaje.*foro/i,
          /foro.*mensaje/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Participar en un foro:</b>
            <ol>
              <li>Entra al curso y busca la actividad <b>Foro</b>.</li>
              <li>Haz clic en el t√≠tulo del foro.</li>
              <li>Abre un tema existente o crea uno nuevo.</li>
              <li>Escribe tu mensaje, adjunta archivos si es necesario.</li>
              <li>Pulsa <b>Enviar al foro</b>.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------------------
      // Notificaciones y retroalimentaci√≥n (campana + preferencias).
      // Patrones: t√©rminos gen√©ricos "notificaciones/avisos/mensajes".
      // -------------------------------------------------------------------
      {
        id: "alumno_notificaciones",
        patterns: [
          /notificaciones/i,
          /avisos.*plataforma/i,
          /mensajes.*moodle/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Recibir notificaciones:</b>
            <ol>
              <li>Haz clic en la <b>campana de notificaciones</b> en la barra superior.</li>
              <li>Activa notificaciones por correo o SMS en <b>Perfil ‚Üí Preferencias ‚Üí Preferencias de Notificaciones</b>.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------
      // Ordenar/organizar cursos en el √°rea personal del alumno.
      // Patrones: "ordenar/organizar/ver ordenados".
      // -------------------------------------------------------
      {
        id: "alumno_ordenar_cursos",
        patterns: [
          /ordenar.*cursos/i,
          /organizar.*cursos/i,
          /ver.*cursos.*ordenados/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Ordenar tus cursos:</b>
            <ol>
              <li>Ve a la p√°gina principal de tu √°rea personal.</li>
              <li>En <b>Mis cursos</b>, selecciona ordenar por fecha o alfab√©ticamente.</li>
            </ol>
          </div>
        `
      },

      // --------------------------------------------------------------------
      // Consultar entregas y penalizaciones por retraso en tareas.
      // Patrones: "consultar/ver/revisar" + "entregas/retraso".
      // --------------------------------------------------------------------
      {
        id: "alumno_consultar_entregas",
        patterns: [
          /consultar.*entregas/i,
          /ver.*tareas.*entregadas/i,
          /revisar.*retraso.*tareas/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Consultar tus entregas y penalizaciones:</b>
            <ol>
              <li>Entra a tu curso.</li>
              <li>Ve a la secci√≥n <b>Tareas</b>.</li>
              <li>Haz clic en la tarea para ver fecha, estado y penalizaciones si hubo retrasos.</li>
            </ol>
          </div>
        `
      },

      // --------------------------------------------------------------------------------
      // Reproducci√≥n de contenidos H5P en app m√≥vil (autoplay sujeto a compatibilidad).
      // Patrones: "h5p m√≥vil", "reproducir h5p app", "h5p autom√°tico".
      // Nota: aclaramos que no todos los tipos admiten autoplay por restricciones.
      // --------------------------------------------------------------------------------
      {
        id: "alumno_h5p_movil",
        patterns: [
          /h5p.*m[o√≥]vil/i,
          /reproducir.*h5p.*app/i,
          /h5p.*autom[a√°]tico/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>H5P en la app m√≥vil:</b>
            <ol>
              <li>Abre la actividad H5P en la app Moodle.</li>
              <li>Si el contenido permite reproducci√≥n autom√°tica, habil√≠tala desde el editor H5P en la web.</li>
              <li>Ten en cuenta que no todos los contenidos H5P admiten autoplay en m√≥viles.</li>
            </ol>
          </div>
        `
      }



      ];

      // --- UI wiring ---
      const msgs = document.getElementById('nc-msgs');
      // ‚õ≥Ô∏è eliminamos la l√≠nea que declaraba 'form' (ya no se usa)
      const input = document.getElementById('nc-input'); // ‚Üê una sola vez
      const sendBtn = document.getElementById('nc-send');

      const typeMessage = text => {
        let i = 0;
        const div = document.createElement('div');
        div.className = 'mensaje-inicial'; // Usamos clase para aplicar estilos din√°micos
        msgs.appendChild(div);

        const interval = setInterval(() => {
          div.innerHTML = text.substring(0, i) +
            "<span class='cursor-escribiendo'></span>";
          i++;
          msgs.scrollTop = msgs.scrollHeight;
          if (i > text.length) {
            clearInterval(interval);
            div.innerHTML = text;
          }
        }, 30);
      };
      typeMessage("üëã ¬°Hola! Soy el Chatbot TAC. Preg√∫ntame sobre el proyecto, la Unidad TAC o el calendario acad√©mico.");



      let typingEl = null;

        function showTyping(){
          // crea una burbuja de bot con puntos animados
          const html = `<span class="nc-typing">
                          <span class="nc-dot-typing"></span>
                          <span class="nc-dot-typing"></span>
                          <span class="nc-dot-typing"></span>
                        </span>`;
          const el = document.createElement('div');
          el.className = 'nc-bubble nc-bot';
          el.innerHTML = html;
          document.getElementById('nc-msgs').appendChild(el);
          document.getElementById('nc-msgs').scrollTop = document.getElementById('nc-msgs').scrollHeight;
          typingEl = el;
        }

        function hideTyping(){
          if(typingEl && typingEl.parentNode){
            typingEl.parentNode.removeChild(typingEl);
            typingEl = null;
          }
        }


        // --- Tema claro/oscuro ---
        const ncRoot  = document.getElementById('nc-bot'); // tiene la clase "nc"
        const themeBtn= document.getElementById('nc-theme');

        function applyTheme(theme){
          if (theme === 'dark') {
            ncRoot.classList.add('nc-dark');
            themeBtn.textContent = '‚òÄÔ∏è Modo claro';
            themeBtn.setAttribute('aria-pressed','true');
          } else {
            ncRoot.classList.remove('nc-dark');
            themeBtn.textContent = 'üåô Modo oscuro';
            themeBtn.setAttribute('aria-pressed','false');
          }
          localStorage.setItem('ncTheme', theme);
        }

        // Preferencia inicial: guardada o del sistema
        const savedTheme = localStorage.getItem('ncTheme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        applyTheme(savedTheme ? savedTheme : (prefersDark ? 'dark' : 'light'));

        // Toggle al hacer click (chat)
        themeBtn.addEventListener('click', ()=>{
          const isDark = ncRoot.classList.contains('nc-dark');
          applyTheme(isDark ? 'light' : 'dark');
        });
        // Toggle al hacer click (faq)
        const themeBtnFaq = document.getElementById('themeToggleFaq');
        if (themeBtnFaq) {
          themeBtnFaq.addEventListener('click', ()=>{
            const isDark = ncRoot.classList.contains('nc-dark');
            applyTheme(isDark ? 'light' : 'dark');
          });
        }

        // Navegaci√≥n entre vistas (pantallas exclusivas)
        const viewChat = document.getElementById('view-chat');
        const viewFaq  = document.getElementById('view-faq');
        const toFaqBtn = document.getElementById('toFaq');
        const backBtn  = document.getElementById('backToBot');

        function swapViews(hideEl, showEl, focusEl){
          if (!hideEl || !showEl) return;
          // salida
          hideEl.classList.add('fade-exit');
          requestAnimationFrame(()=>{
            hideEl.classList.add('fade-exit-active');
            setTimeout(()=>{
              hideEl.classList.remove('fade-exit','fade-exit-active');
              hideEl.classList.remove('active');
              hideEl.setAttribute('aria-hidden','true');
              // entrada
              showEl.classList.add('active','fade-enter');
              showEl.setAttribute('aria-hidden','false');
              requestAnimationFrame(()=>{
                showEl.classList.add('fade-enter-active');
                setTimeout(()=>{
                  showEl.classList.remove('fade-enter','fade-enter-active');
                }, 260);
              });
              if (focusEl) setTimeout(()=> focusEl.focus(), 0);
              window.scrollTo({ top: 0, behavior: 'instant' });
            }, 200);
          });
        }

        if (toFaqBtn) {
          toFaqBtn.addEventListener('click', ()=>{
            const faqTitle = document.getElementById('faqTitle');
            swapViews(viewChat, viewFaq, faqTitle);
          });
        }
        if (backBtn) {
          backBtn.addEventListener('click', ()=>{
            swapViews(viewFaq, viewChat, themeBtn);
          });
        }

        // FAQ: l√≥gica de secciones y expandir/contraer
        const sectionStudent = document.getElementById('estudiante');
        const sectionTeacher = document.getElementById('docente');
        const expandAllBtn = document.getElementById('expandAllBtn');
        const collapseAllBtn = document.getElementById('collapseAllBtn');

        window.showSection = function(name){
          if (name === 'estudiante'){
            sectionStudent.classList.add('active');
            sectionTeacher.classList.remove('active');
            localStorage.setItem('activeRole','estudiante');
          } else {
            sectionTeacher.classList.add('active');
            sectionStudent.classList.remove('active');
            localStorage.setItem('activeRole','docente');
          }
          // desplaza a inicio de la secci√≥n
          const el = name==='estudiante'?sectionStudent:sectionTeacher;
          el.scrollIntoView({behavior:'smooth', block:'start'});
        };

        function toggleDetails(container, open){
          const details = container.querySelectorAll('details');
          details.forEach(d=>{ d.open = open; });
        }
        if (expandAllBtn){
          expandAllBtn.addEventListener('click', ()=>{
            const role = localStorage.getItem('activeRole')||'estudiante';
            toggleDetails(role==='estudiante'?sectionStudent:sectionTeacher, true);
          });
        }
        if (collapseAllBtn){
          collapseAllBtn.addEventListener('click', ()=>{
            const role = localStorage.getItem('activeRole')||'estudiante';
            toggleDetails(role==='estudiante'?sectionStudent:sectionTeacher, false);
          });
        }

        // FAQ: buscador con sugerencias y resaltado b√°sico
        const searchInput = document.getElementById('searchInput');
        const suggestions = document.getElementById('questions-suggestions');

        function normalize(s){
          return (s||'').toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').trim();
        }
        function highlight(text, query){
          if (!query) return text;
          const q = normalize(query);
          const idx = normalize(text).indexOf(q);
          if (idx === -1) return text;
          return text.substring(0, idx) + '<span class="highlight">' + text.substring(idx, idx+query.length) + '</span>' + text.substring(idx+query.length);
        }
        function collectQuestions(){
          const items = [];
          [sectionStudent, sectionTeacher].forEach(sec=>{
            if(!sec) return;
            sec.querySelectorAll('details > summary').forEach(sum=>{
              items.push({summary: sum, text: sum.textContent.trim(), section: sec});
            });
          });
          return items;
        }
        const allQuestions = collectQuestions();

        function renderSuggestions(list){
          suggestions.innerHTML = '';
          if (!list.length){ suggestions.style.display='none'; return; }
          suggestions.style.display='block';
          list.slice(0, 8).forEach(item=>{
            const div = document.createElement('div');
            div.className = 'suggestion-item';
            div.innerHTML = highlight(item.text, searchInput.value);
            div.addEventListener('click', ()=>{
              // mostrar secci√≥n correspondiente
              if (item.section === sectionStudent) showSection('estudiante'); else showSection('docente');
              // abrir el details y enfocar
              const details = item.summary.parentElement;
              details.open = true;
              details.scrollIntoView({behavior:'smooth', block:'start'});
              searchInput.value = '';
              suggestions.style.display='none';
            });
            suggestions.appendChild(div);
          });
        }

        if (searchInput){
          searchInput.addEventListener('input', ()=>{
            const q = normalize(searchInput.value);
            if (!q){ suggestions.style.display='none'; suggestions.innerHTML=''; return; }
            const matches = allQuestions.filter(it=> normalize(it.text).includes(q));
            renderSuggestions(matches);
          });
          document.addEventListener('click', (e)=>{
            if (!suggestions.contains(e.target) && e.target !== searchInput){
              suggestions.style.display='none';
            }
          });
        }

        // restaurar rol activo
        const savedRole = localStorage.getItem('activeRole') || 'estudiante';
        showSection(savedRole);



      const bubble = (html, who) => {
        const p = document.createElement('div');
        p.className = 'nc-bubble ' + (who === 'me' ? 'nc-me' : 'nc-bot');
        p.innerHTML = html;
        const msgs = document.getElementById('nc-msgs');
        msgs.appendChild(p);
        msgs.scrollTop = msgs.scrollHeight;
        return p; // ‚Üê ahora devolvemos el elemento
      };



      const matchIntent = text => {
        const q = norm(text);
        for (const intent of INTENTS) {
          if (intent.patterns.some(rx => rx.test(q))) return intent;
        }
        return null;
      };

      function renderSuggestions(intentId, bubbleEl){
        const items = SUGGESTIONS[intentId];
        if (!items || !items.length || !bubbleEl) return;
        const wrap = document.createElement('div');
        wrap.className = 'nc-suggest';
        items.forEach(it=>{
          const b = document.createElement('button');
          b.type = 'button';
          b.className = 'nc-chip';
          b.textContent = it.label;
          b.addEventListener('click', ()=> sendText(it.q));
          wrap.appendChild(b);
        });
        bubbleEl.appendChild(wrap);
      }

      function renderMedia(intentId, bubbleEl){
        const m = MEDIA[intentId];
        if (!m || !m.img) return;
        const box = document.createElement('div');
        box.className = 'nc-media';
        box.innerHTML = `<img src="${m.img}" alt="${m.alt || ''}">`;
        bubbleEl.appendChild(box);
      }



      function handleSend() {
      const t = input.value.trim();
      if (!t) return;
      bubble(t, 'me');
      input.value = '';

      showTyping();
      setTimeout(() => {
        try {
          const intent = matchIntent(t);
          hideTyping();
          if (intent) {
            const el = bubble(intent.answer, 'bot');     // ‚Üê guardamos el nodo
            renderSuggestions(intent.id, el);  
            renderMedia(intent.id, el);          
          } else {
            bubble("<i>No tengo esa respuesta a√∫n. Prueba con: ‚Äúproyecto‚Äù, ‚Äúunidad TAC‚Äù, ‚Äúcalendario acad√©mico‚Äù o ‚Äúsoporte plataformas‚Äù.</i>", 'bot');
          }
        } catch (err) {
          hideTyping();
          bubble(`<span style="color:#b00020">‚ö†Ô∏è Error: ${err.message}</span>`, 'bot');
          console.error(err);
        }
}, 500);
 // puedes subir un poco el delay para que se note el typing
    }


      sendBtn.addEventListener('click', handleSend);

      // Utilidad para enviar texto program√°ticamente
        function sendText(t){
          bubble(t,'me');
          input.value = '';
          showTyping();
          setTimeout(()=>{
            try{
              const intent = matchIntent(t);
              hideTyping();
              if (intent) {
                const el = bubble(intent.answer,'bot');
                renderSuggestions(intent.id, el);
                renderMedia(intent.id, el);
              } else {
                bubble("<i>No tengo esa respuesta a√∫n. Prueba con: ‚Äúproyecto‚Äù, ‚Äúunidad TAC‚Äù, ‚Äúcalendario acad√©mico‚Äù o ‚Äúsoporte plataformas‚Äù.</i>", 'bot');
              }
            }catch(err){
              hideTyping();
              bubble(`<span style="color:#b00020">‚ö†Ô∏è Error: ${err.message}</span>`,'bot');
              console.error(err);
            }
          }, 500);

        }


        // Listeners de chips
        document.querySelectorAll('.nc-chip').forEach(ch=>{
          ch.addEventListener('click', ()=>{
            const q = ch.getAttribute('data-q') || '';
            if(q) sendText(q);
          });
        });

      // Autocompletado del chat
      (function(){
        const inputEl = document.getElementById('nc-input');
        const list = document.getElementById('chat-suggestions');
        let allChatHints = [];
        let activeIndex = -1;

        function normalize(s){ return (s||'').toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').trim(); }

        // Construir cat√°logo: labels/q de SUGGESTIONS + t√≠tulos del FAQ
        function collectFaqTitles(){
          const titles = [];
          const faqRoot = document.getElementById('view-faq');
          if(!faqRoot) return titles;
          faqRoot.querySelectorAll('details > summary').forEach(sum=>{
            const text = sum.textContent.trim();
            titles.push({label: text, q: text});
          });
          return titles;
        }
        function collectSuggestionPairs(){
          const items = [];
          try {
            const keys = Object.keys(SUGGESTIONS||{});
            keys.forEach(k=>{
              (SUGGESTIONS[k]||[]).forEach(it=>{ if(it && it.q){ items.push({label: it.label||it.q, q: it.q}); } });
            });
          } catch(_){}
          return items;
        }
        function buildCatalog(){
          const a = collectSuggestionPairs();
          const b = collectFaqTitles();
          // deduplicar por q
          const seen = new Set();
          const merged = [];
          [...a, ...b].forEach(it=>{
            const key = it.q;
            if(!seen.has(key)) { seen.add(key); merged.push(it); }
          });
          allChatHints = merged;
        }
        buildCatalog();

        function render(items){
          if(!items.length){ list.style.display='none'; list.innerHTML=''; activeIndex=-1; return; }
          list.innerHTML = items.map((it,i)=>`<div class="nc-suggest-item${i===0?' active':''}" data-q="${it.q.replace(/"/g,'&quot;')}">${it.label}</div>`).join('');
          list.style.display='block';
          activeIndex = 0;
          Array.from(list.children).forEach((node, idx)=>{
            node.addEventListener('mouseenter', ()=> setActive(idx));
            node.addEventListener('mousedown', (ev)=>{ ev.preventDefault(); completeAndSend(idx); });
          });
        }
        function setActive(idx){
          const nodes = Array.from(list.children);
          nodes.forEach(n=> n.classList.remove('active'));
          if(idx>=0 && idx<nodes.length){ nodes[idx].classList.add('active'); activeIndex=idx; }
        }
        function completeAndSend(idx){
          const nodes = Array.from(list.children);
          if(!nodes.length) return;
          const node = nodes[idx>=0?idx:0];
          const q = node.getAttribute('data-q') || node.textContent.trim();
          list.style.display='none'; list.innerHTML=''; activeIndex=-1;
          if(q){ inputEl.value = q; handleSend(); }
        }

        inputEl.addEventListener('input', ()=>{
          const q = normalize(inputEl.value);
          if(!q){ list.style.display='none'; list.innerHTML=''; return; }
          const filtered = allChatHints.filter(it=> normalize(it.label).includes(q) || normalize(it.q).includes(q)).slice(0,8);
          render(filtered);
        });
        inputEl.addEventListener('keydown', (e)=>{
          const visible = list.style.display==='block';
          if(!visible){
            if(e.key==='Enter'){ e.preventDefault(); handleSend(); }
            return;
          }
          const nodes = Array.from(list.children);
          if(e.key==='ArrowDown'){ e.preventDefault(); setActive(Math.min(nodes.length-1, activeIndex+1)); }
          else if(e.key==='ArrowUp'){ e.preventDefault(); setActive(Math.max(0, activeIndex-1)); }
          else if(e.key==='Enter'){ e.preventDefault(); completeAndSend(activeIndex); }
          else if(e.key==='Escape'){ list.style.display='none'; list.innerHTML=''; activeIndex=-1; }
        });
        document.addEventListener('click', (e)=>{ if(!list.contains(e.target) && e.target!==inputEl){ list.style.display='none'; }});
      })();

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          handleSend();
        }
      });
    })();
  </script>
</p>