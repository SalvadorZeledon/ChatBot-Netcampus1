<div id="nc-bot" class="nc" style="font-family: system-ui,Arial;">
  <div class="nc-card">
    <strong class="nc-header">ü§ñ Chatbot de Prueba - Unidad TAC</strong>

    <div class="nc-toolbar">
      <button id="nc-theme" class="nc-theme-btn" type="button" aria-pressed="false" title="Cambiar tema">
        üåô Modo oscuro
      </button>
    </div>


    <div id="nc-msgs" class="nc-msgs"></div>
    <div id="nc-quick" class="nc-quick">
      <button class="nc-chip" data-q="¬øPuedes comentarme en qu√© consiste el nuevo proyecto de la Unidad TAC?">Proyecto TAC</button>
      <button class="nc-chip" data-q="¬øCu√°ndo inicia y cu√°ndo termina el ciclo 02-2025?">Calendario</button>
      <button class="nc-chip" data-q="¬øCu√°les son las pol√≠ticas de evaluaci√≥n?">Pol√≠ticas</button>
     <button class="nc-chip" data-q="¬øTienes un video para matriculaci√≥n?">Video matriculaci√≥n</button>
    </div>

    <div id="nc-form" class="nc-form">
      <input id="nc-input" class="nc-input" type="text" placeholder="Escribe tu pregunta‚Ä¶" required>
      <button id="nc-send" class="nc-send" type="button">Enviar</button>
    </div>
  </div>
</div>

<style>
  :root{
    --nc-primary:#1f57b6;  /* azul institucional */
    --nc-accent:#19b36b;   /* verde acento */
    --nc-danger:#d9534f;   /* rojo para botones de video */
    --nc-bg:#f6f9ff;
    --nc-text:#111;
  }

  .nc{color:var(--nc-text)}
  .nc-card{
    border:1px solid #e6e8f0; border-radius:16px; background:#fff;
    box-shadow:0 14px 38px rgba(0,0,0,.06); max-width:820px; margin:8px auto;
  }
  .nc-header{
    display:block; padding:14px 16px; border-radius:16px 16px 0 0; color:#fff;
    background:linear-gradient(90deg,var(--nc-primary), var(--nc-accent));
    font-weight:800; letter-spacing:.2px;
  }
  .nc-msgs{padding:16px; max-height:420px; overflow:auto; background:var(--nc-bg)}
  .nc-bubble{
    margin:10px 0; max-width:82%; padding:10px 12px; border-radius:14px; line-height:1.45;
    box-shadow:0 3px 10px rgba(0,0,0,.05); border:1px solid #e8ecf6; word-wrap:break-word;
  }
  .nc-bubble.nc-bot{background:#fff}
  .nc-bubble.nc-me {background:#e8f2ff; border-color:#cfe1ff; margin-left:auto}

  .nc-form{display:flex; gap:10px; padding:14px 16px; border-top:1px solid #eef2ff; background:#fff; border-radius:0 0 16px 16px}
  .nc-input{flex:1; padding:12px 14px; border:1px solid #d8dce8; border-radius:12px; background:#fbfbfe}
  .nc-send{padding:12px 16px; border-radius:12px; border:1px solid var(--nc-primary); background:var(--nc-primary); color:#fff; cursor:pointer; font-weight:700}
  .nc-send:hover{filter:brightness(.96)}

  /* Botones tipo enlace dentro de respuestas del bot */
  #nc-msgs a{
    display:inline-block; padding:8px 12px; border-radius:10px; text-decoration:none; font-weight:700;
    border:1px solid var(--nc-primary); background:#eef1ff; color:var(--nc-primary); margin-top:6px;
  }
  #nc-msgs a.primary{background:var(--nc-primary); color:#fff}
  #nc-msgs a.success{background:var(--nc-accent); color:#fff; border-color:var(--nc-accent)}
  #nc-msgs a.danger{background:var(--nc-danger); color:#fff; border-color:var(--nc-danger)}

  .nc-quick{display:flex;flex-wrap:wrap;gap:10px;padding:10px 16px;border-top:1px solid #eef2ff;background:#fbfdff}
  .nc-chip{
    background:#eef4ff;border:1px solid #dbe6ff;color:var(--nc-primary);
    border-radius:999px;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:600
  }
  .nc-chip:hover{background:#e2ecff}

</style>

<style>
  .nc-typing{display:inline-flex;gap:4px;align-items:center}
  .nc-dot-typing{
    width:6px;height:6px;border-radius:50%;background:#9aa7c7;
    opacity:.6;animation:nc-bounce 1s infinite ease-in-out;
  }
  .nc-dot-typing:nth-child(2){animation-delay:.15s}
  .nc-dot-typing:nth-child(3){animation-delay:.3s}

  @keyframes nc-bounce{
    0%,80%,100%{transform:translateY(0);opacity:.6}
    40%{transform:translateY(-4px);opacity:1}
  }
</style>

<style>
  .nc-suggest{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .nc-suggest .nc-chip{
    background:#eef4ff;border:1px solid #dbe6ff;color:var(--nc-primary);
    border-radius:999px;padding:6px 10px;cursor:pointer;font-size:12px;font-weight:600
  }
  .nc-suggest .nc-chip:hover{background:#e2ecff}
</style>

<style>
  .nc-media{margin-top:10px}
  .nc-media img{
    max-width:100%;
    height:auto;
    display:block;
    border-radius:12px;
    border:1px solid #e6e8f0;
    box-shadow:0 6px 16px rgba(0,0,0,.06);
  }
</style>

<style>
  /* Barra superior con bot√≥n de tema */
  .nc-toolbar{display:flex;justify-content:flex-end;gap:8px;padding:8px 12px;background:#fff;border-bottom:1px solid #eef2ff}
  .nc-theme-btn{
    padding:8px 12px;border-radius:10px;border:1px solid var(--nc-primary);
    background:var(--nc-primary);color:#fff;font-weight:700;cursor:pointer
  }
  .nc-theme-btn:hover{filter:brightness(.96)}

  /* ---- Tema oscuro mejor contraste ---- */
.nc.nc-dark {
  color: #e8ecf7; /* Texto general claro */
}

.nc.nc-dark .nc-card {
  background: #14182a;
  border-color: #2a2e3f;
  box-shadow: none;
}

.nc.nc-dark .nc-header {
  background: linear-gradient(90deg, #1b3e8e, #146a43);
  color: #ffffff;
}

.nc.nc-dark .nc-toolbar {
  background: #14182a;
  border-bottom-color: #2a2e3f;
}

.nc.nc-dark .nc-msgs {
  background: #0f1220;
}

.nc.nc-dark .nc-bubble.nc-bot {
  background: #1b2138;
  border-color: #2a3353;
  color: #f5f7ff; /* texto claro */
}

.nc.nc-dark .nc-bubble.nc-me {
  background: #21407a;
  border-color: #21407a;
  color: #ffffff;
}

.nc.nc-dark .nc-input {
  background: #0f1220;
  color: #f5f7ff;
  border-color: #2a3353;
}

.nc.nc-dark .nc-send {
  background: #4f8bff;
  border-color: #4f8bff;
  color: #ffffff;
}

.nc.nc-dark #nc-msgs a {
  background: #3b4770;
  border-color: #3b4770;
  color: #ffffff;
}

.nc.nc-dark #nc-msgs a.success {
  background: #58d39a;
  border-color: #58d39a;
  color: #0b0e1a;
}

.nc.nc-dark #nc-msgs a.danger {
  background: #ff6b6b;
  border-color: #ff6b6b;
  color: #0b0e1a;
}

.nc.nc-dark .nc-quick {
  background: #13182a;
  border-top-color: #2a2e3f;
}

.nc.nc-dark .nc-chip {
  background: #1b2138;
  border-color: #2a3353;
  color: #ffffff;
}

.nc.nc-dark .nc-chip:hover {
  background: #232b49;
}

.nc.nc-dark .nc-suggest .nc-chip {
  background: #1b2138;
  border-color: #2a3353;
  color: #ffffff;
}

/* Dots ‚Äúescribiendo‚Ä¶‚Äù visibles */
.nc.nc-dark .nc-dot-typing {
  background: #cfe0ff;
  opacity: 0.9;
}


  /* Dots de ‚Äúescribiendo‚Ä¶‚Äù m√°s visibles en oscuro */
  .nc.nc-dark .nc-dot-typing{background:#cfe0ff;opacity:.8}
</style>

<style>
.respuesta-bloque {
  background: var(--bg-bloque);
  color: var(--texto-bloque);
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid var(--borde-bloque);
}

.boton-video a {
  display: inline-block;
  padding: 8px 12px;
  border-radius: 8px;
  background: #d9534f;
  color: #fff;
  text-decoration: none;
  font-weight: 600;
}

/* Variables para modo claro */
body.light-mode {
  --bg-input-area: #ffffff;
  --bg-input: #f9f9f9;
  --border-input: #ccc;
  --text-input: #000;
  --bg-button: #4a90e2;
  --text-button: #fff;
}

/* Variables para modo oscuro */
body.dark-mode {
  --bg-input-area: #121212;
  --bg-input: #1e1e1e;
  --border-input: #444;
  --text-input: #fff;
  --bg-button: #2979ff;
  --text-button: #fff;
}

/* Contenedor del input y bot√≥n */
#nc-form {
  background: var(--bg-input-area);
  padding: 10px;
  display: flex;
  gap: 5px;
}

/* Input */
#nc-input {
  background: var(--bg-input);
  border: 1px solid var(--border-input);
  color: var(--text-input);
  flex: 1;
  padding: 6px;
  border-radius: 6px;
}

/* Bot√≥n de enviar */
#nc-send {
  background: var(--bg-button);
  color: var(--text-button);
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
}

</style>

<style >
.mensaje-inicial {
  background: var(--bg-msg);
  padding: 6px;
  border-radius: 6px;
  margin: 4px 0;
  border: 1px solid var(--border-msg);
}

.cursor-escribiendo {
  border-right: 1px solid var(--cursor-color);
}

body.light-mode {
  --bg-msg: #f1f1f1;
  --border-msg: #ccc;
  --cursor-color: #333;
}

body.dark-mode {
  --bg-msg: #1f1f1f;
  --border-msg: #444;
  --cursor-color: #fff;
}
</style>
<p>
  <script>
    (function() {
      // --- util ---
      const norm = s => (s || "")
        .toLowerCase()
        .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
        .replace(/[¬ø?¬°!.,:;()"]/g, " ")
        .replace(/\s+/g, " ")
        .trim();

      // URL de los videos
      const VIDEO_MATRICULACION = "https://www.youtube.com/watch?v=XXXXXXXX";

      const VIDEO_PAGINA = "https://www.youtube.com/watch?v=YYYYYYYY"; // ‚Üê cambia por tu enlace

      const VIDEO_TAREA = "https://www.youtube.com/watch?v=AAAAAAAA"; // ‚Üê pon tu enlace real
      
      const VIDEO_FORO = "https://www.youtube.com/watch?v=BBBBBBBB"; // ‚Üê reemplaza con tu enlace real

      const VIDEO_PERFIL = "https://www.youtube.com/watch?v=BBBBBBBB";

      // Imagen opcional para respuestas (s√∫bela a Moodle y pega el URL p√∫blico)
      const IMG_CALENDARIO = "https://scontent.fsal2-2.fna.fbcdn.net/v/t39.30808-6/484553841_9387352094687408_6800608587075683597_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=833d8c&_nc_ohc=w4laWYBlHcEQ7kNvwF4HyrB&_nc_oc=Adm2MqO6s8jhnkX06a8gDTY_cvQaumGmd7jfEFY3ZtMydrcFUj-cOQ2X9hq_RJo55vs0pGzwhAI3QBgueSTS-Yss&_nc_zt=23&_nc_ht=scontent.fsal2-2.fna&_nc_gid=MsiTGgaZaTuUwqOpHQIdAA&oh=00_AfUBHRD8F1QfV2Cpd-3IdwY0RNoGb-aL9S5BknwstCpbdg&oe=68A0B739 "; // deja "" si no quieres imagen



      // Sugerencias contextuales seg√∫n el intent respondido
      const SUGGESTIONS = {
        video_matriculacion: [
          { label: "Ver calendario", q: "¬øCu√°ndo inicia y cu√°ndo termina el ciclo 02-2025?" },
          { label: "Crear P√°gina",   q: "¬øC√≥mo crear una P√°gina en Moodle 5?" },
          { label: "Contacto TAC",   q: "¬øC√≥mo puedo contactar a la Unidad?" }
        ],
        proyecto: [
          { label: "Beneficios", q: "¬øCu√°les son los beneficios para estudiantes y docentes?" },
          { label: "Objetivo",   q: "¬øCu√°l es el objetivo principal?" },
          { label: "Documentos", q: "¬øPuedes mostrarme los documentos que tienes a disposici√≥n?" }
        ],
        calendario_academico: [
          { label: "1ros parciales", q: "¬øCu√°ndo son los primeros parciales?" },
          { label: "2dos parciales", q: "¬øCu√°ndo son los segundos parciales?" },
          { label: "Finales",        q: "¬øCu√°ndo son los ex√°menes finales?" }
        ],
        crear_pagina: [
          { label: "Crear Tarea", q: "¬øC√≥mo crear una Tarea en Moodle 5?" },
          { label: "Crear Foro",  q: "¬øC√≥mo crear un Foro en Moodle 5?" },
          { label: "Perfil Docente", q: "¬øC√≥mo configurar mi perfil como docente?" }
        ],
        crear_tarea: [
          { label: "Crear Foro",  q: "¬øC√≥mo crear un Foro en Moodle 5?" },
          { label: "Crear P√°gina",q: "¬øC√≥mo crear una P√°gina en Moodle 5?" }
        ],
        crear_foro: [
          { label: "Crear Tarea", q: "¬øC√≥mo crear una Tarea en Moodle 5?" },
          { label: "Crear P√°gina",q: "¬øC√≥mo crear una P√°gina en Moodle 5?" }
        ],
        configurar_perfil_docente: [
          { label: "Crear P√°gina", q: "¬øC√≥mo crear una P√°gina en Moodle 5?" },
          { label: "Contacto TAC", q: "¬øC√≥mo puedo contactar a la Unidad?" }
        ]
      };


      // Im√°genes por intenci√≥n (solo se inyectan si hay URL)
      const MEDIA = {
        calendario_academico: { img: IMG_CALENDARIO, alt: "Calendario acad√©mico 02-2025" }
        // Ejemplos futuros:
        // crear_tarea: { img: IMG_TAREA, alt: "Flujo para crear Tarea" },
        // crear_foro:  { img: IMG_FORO,  alt: "Tipos de foro en Moodle" }
      };


      // --- intenciones ---
      const INTENTS = [{
        // --- PARA CLAVE DE MATRICULACION ---
        id: "video_matriculacion",
        patterns: [
          /matriculaci(o|on|√≥n)/,
          /(clave|contrasena|contrase√±a).*(matricul)/,
          /ayuda.*(matricul|clave)/,
          /video.*matricul/,
          /tutorial.*matricul/
        ],
       answer: `
          <div class="respuesta-bloque">
            <b>Configurar clave de matriculaci√≥n en Moodle 5:</b>
            <ol>
              <li>Entra al curso y abre <b>Ajustes del curso</b> (engrane superior).</li>
              <li>Ve a <b>Usuarios ‚Üí M√©todos de matriculaci√≥n</b>.</li>
              <li>Activa <b>Auto-matriculaci√≥n (Estudiante)</b>.</li>
              <li>Haz clic en el engrane, escribe la clave y guarda.</li>
            </ol>
            <div class="boton-video">
              <a href="${VIDEO_MATRICULACION}" target="_blank" rel="noopener">
                üé• Ver video tutorial
              </a>
            </div>
          </div>
`
    },
          // --- PARA CREAR UNA PAGINA ---
          {
            id: "crear_pagina",
            patterns: [
              /crear.*pagina/,
              /configurar.*pagina/,
              /recurso.*pagina/,
              /como.*(crear|configurar).*pagina/,
              /pagina.*moodle/,
              /\bpage\b/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Crear una P√°gina en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Activa <b>Edici√≥n</b> en el curso.</li>
                  <li>Haz clic en <b>A√±adir una actividad o un recurso</b> ‚Üí <b>P√°gina</b>.</li>
                  <li>Completa <b>Nombre</b> y el <b>Contenido</b> (puedes usar <i>C√≥digo fuente</i> para HTML).</li>
                  <li>(Opcional) Ajusta <b>Restricciones</b> y <b>Finalizaci√≥n</b>.</li>
                  <li>Pulsa <b>Guardar y mostrar</b>.</li>
                </ol>
                 <div class="boton-video">
                  <a href="${VIDEO_PAGINA}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#1f57b6;color:#fff;text-decoration:none;font-weight:600;">
                    üé• Ver video: crear P√°gina
                  </a>
                </div>
              </div>
            `
          },
          // --- PARA CREAR UNA TAREA---
          {
            id: "crear_tarea",
            patterns: [
              /crear.*tarea/,
              /configurar.*tarea/,
              /actividad.*tarea/,
              /como.*(crear|configurar).*tarea/,
              /tarea.*moodle/,
              /assignment/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Crear una Tarea en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Activa <b>Edici√≥n</b> en el curso.</li>
                  <li>Ve a <b>A√±adir una actividad o un recurso</b> ‚Üí <b>Tarea</b>.</li>
                  <li>Completa <b>Nombre</b> y <b>Descripci√≥n</b>.</li>
                  <li>En <b>Disponibilidad</b>: define apertura, entrega y fecha l√≠mite.</li>
                  <li>En <b>Tipos de entrega</b>: archivos, texto en l√≠nea o ambos.</li>
                  <li>Ajusta <b>Calificaci√≥n</b> y dem√°s opciones si hace falta.</li>
                  <li>Pulsa <b>Guardar y mostrar</b>.</li>
                </ol>
                <div class="boton-video">
                  <a href="${VIDEO_TAREA}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#1f57b6;color:#fff;text-decoration:none;font-weight:600;">
                    üé• Ver video: crear Tarea
                  </a>
                </div>
              </div>
            `
          },
          // --- PARA CREAR UN FORO---
          {
            id: "crear_foro",
            patterns: [
              /crear.*foro/,
              /configurar.*foro/,
              /foro.*moodle/,
              /como.*(crear|configurar).*foro/,
              /forum/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Crear un Foro en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Activa <b>Edici√≥n</b> en el curso.</li>
                  <li>Ve a <b>A√±adir una actividad o un recurso</b> ‚Üí <b>Foro</b>.</li>
                  <li>Completa <b>Nombre</b> y <b>Descripci√≥n</b>.</li>
                  <li>Elige <b>Tipo de foro</b> (est√°ndar, P&amp;R, etc.).</li>
                  <li>(Opcional) Ajusta <b>Suscripci√≥n</b> y <b>Calificaci√≥n</b>.</li>
                  <li>Pulsa <b>Guardar y mostrar</b>.</li>
                </ol>
               <div class="boton-video">
                  <a href="${VIDEO_FORO}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#1f57b6;color:#fff;text-decoration:none;font-weight:600;">
                    üé• Ver video: crear Foro
                  </a>
                </div>
              </div>
            `
          },
          // --- PARA Configurar el perfil---
          {
            id: "configurar_perfil_docente",
            patterns: [
              /configurar mi perfil/,
              /editar perfil profesor/,
              /actualizar perfil/,
              /cambiar foto perfil/,
              /perfil catedratico/,
              /perfil docente/
            ],
            answer: `
              <div class="respuesta-bloque">
                <b>Configurar tu perfil como docente en Moodle 5:</b>
                <ol style="margin:6px 0 0 18px;">
                  <li>Inicia sesi√≥n en Moodle.</li>
                  <li>Haz clic en tu nombre o foto (arriba a la derecha).</li>
                  <li>Selecciona <b>Perfil</b> y luego <b>Editar perfil</b>.</li>
                  <li>Actualiza tu informaci√≥n y sube una foto si deseas.</li>
                  <li>Haz clic en <b>Actualizar informaci√≥n personal</b> para guardar.</li>
                </ol>
                <div class="boton-video">
                  <a href="${VIDEO_PERFIL}" target="_blank" rel="noopener"
                    style="display:inline-block;padding:8px 12px;border-radius:8px;background:#007bff;color:#fff;text-decoration:none;font-weight:600;">
                    Ver video tutorial
                  </a>
                </div>
              </div>
            `
          },

          {
          id: "presentacion",
          patterns: [/presentar(te)?/, /presentacion/, /hola/],
          answer: `
        <b>¬°Hola!</b> Soy el <b>Chatbot TAC</b>, un prototipo desarrollado por la Unidad TAC
        para mostrar c√≥mo la <b>inteligencia artificial</b> puede apoyar a docentes y estudiantes.
        Estoy aqu√≠ para responder preguntas sobre el proyecto, la Unidad TAC y darte una idea
        de c√≥mo funcionar√≠a un asistente virtual integrado en todos los cursos.
      `
        },
        {
          id: "bienvenida",
          patterns: [/bienvenid(a|o)?/, /dar la bienvenida/],
          answer: `
        <b>¬°Bienvenido/a al entorno de prueba del Chatbot TAC!</b><br>
        Aqu√≠ puedes interactuar conmigo para conocer m√°s sobre:
        <ul>
          <li>El <b>proyecto de chatbots</b> en la universidad.</li>
          <li>La <b>Unidad TAC</b> y sus funciones.</li>
          <li>Informaci√≥n acad√©mica y de soporte.</li>
        </ul>
        Esta es una demostraci√≥n; en la versi√≥n final estar√© integrado al curso
        con acceso a tus recursos y actividades.
      `
        },
        {
          id: "proyecto",
          patterns: [/proyecto/, /en que consiste/,
            /consiste el nuevo proyecto/
          ],
          answer: `
        El <b>proyecto de chatbots educativos</b> de la Unidad TAC busca incorporar asistentes virtuales en los cursos para:
        <ul>
          <li>Brindar <b>respuestas inmediatas</b> a dudas frecuentes.</li>
          <li>Apoyar a los docentes en <b>gesti√≥n y comunicaci√≥n</b>.</li>
          <li>Mejorar la <b>experiencia de aprendizaje</b> de los estudiantes.</li>
        </ul>
        Esta prueba es solo una muestra de lo que se puede lograr.
      `
        },
        {
          id: "objetivo",
          patterns: [/objetivo(s)?/, /meta principal/],
          answer: `
        El objetivo principal es que <b>cada curso</b> cuente con un asistente virtual
        disponible <b>24/7</b> que pueda responder preguntas, dar recordatorios
        y facilitar la navegaci√≥n por la plataforma.
      `
        },
        {
          id: "beneficios",
          patterns: [/beneficio(s)?/, /ventaja(s)?/],
          answer: `
        <b>Beneficios esperados:</b>
        <ul>
          <li>Ahorro de tiempo para docentes y estudiantes.</li>
          <li>Atenci√≥n inmediata en cualquier momento.</li>
          <li>Informaci√≥n consistente y actualizada.</li>
        </ul>
      `
        },
        {
          id: "unidad_tac",
          patterns: [/unidad tac/, /que es la unidad tac/,
            /tecnologias del aprendizaje/
          ],
          answer: `
        La <b>Unidad de Tecnolog√≠as del Aprendizaje y el Conocimiento (TAC)</b> impulsa la
        integraci√≥n de herramientas digitales en la docencia, brindando soporte, capacitaci√≥n
        y asesor√≠a en innovaci√≥n educativa.
      `
        },
        {
          id: "funcion_tac",
          patterns: [/funcion de la unidad/, /rol(es)? tac/,
            /que hace la unidad tac/
          ],
          answer: `
        <b>Funciones principales de la Unidad TAC:</b>
        <ul>
          <li>Capacitaci√≥n docente en uso de tecnolog√≠a educativa.</li>
          <li>Soporte t√©cnico sobre plataformas.</li>
          <li>Asesor√≠a en dise√±o de cursos virtuales.</li>
        </ul>
      `
        },
        {
          id: "historia_tac",
          patterns: [/historia tac/, /cuando se creo/,
            /desde cuando existe/
          ],
          answer: `
        La Unidad TAC fue creada para modernizar la ense√±anza universitaria mediante
        la adopci√≥n de tecnolog√≠as. Desde su fundaci√≥n ha liderado iniciativas de
        innovaci√≥n y formaci√≥n digital.
      `
        },
        {
          id: "ubicacion_tac",
          patterns: [/como puedo llegar/, /donde (estan|se encuentra)/],
          answer: `
        <b>Ubicaci√≥n:</b> Edificio Central, piso 3, oficina 305.
      `
        },
        {
          id: "contacto_tac",
          patterns: [/contacto/,/contactar/, /contactar a la unidad/,/correo/, /telefono/, /comunicarme/],
          answer: `
        <b>Contacto Unidad TAC:</b><br>
        üìß tac@universidad.edu<br>
        üìû (+504) 1234-5678<br>
        Horario: lunes a viernes, 8:00‚Äì17:00.
      `
        },
        {
          id: "servicios_tac",
          patterns: [/servicio(s)?/, /ofrece la unidad tac/, /que brindan/],
          answer: `
        <b>Servicios de la Unidad TAC:</b>
        <ul>
          <li>Capacitaci√≥n en plataformas virtuales.</li>
          <li>Soporte t√©cnico y resoluci√≥n de problemas.</li>
          <li>Asesor√≠a en dise√±o instruccional y multimedia.</li>
        </ul>
      `
        },
        {
          id: "futuro",
          patterns: [/futuro/, /vision/],
          answer: `
        En el futuro se busca integrar chatbots en todos los cursos,
        conectados a datos reales y con capacidad de dar asistencia
        personalizada a cada estudiante y docente.
      `
        },
        {
          id: "documentos",
          patterns: [/documento(s)?/, /manual/, /guia/],
          answer: `
        üìÑ <a href="#" target="_blank">Documento del Proyecto</a><br>
        üìÑ <a href="#" target="_blank">Manual de Uso del Chatbot</a>
      `
        },
        {
          id: "calendario_academico",
          patterns: [/calendario/, /fechas importantes/, /cuando inicia/,
            /cuando termina/
          ],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìÖ Inicio de clases: <b>14 de julio</b></li>
          <li>üìÖ Finalizaci√≥n: <b>29 de noviembre</b></li>
          <li>üìù Primeros parciales: <b>1 al 6 de septiembre</b></li>
          <li>üìù Segundos parciales: <b>20 al 25 de octubre</b></li>
          <li>üìö Ex√°menes finales: <b>2 al 8 de diciembre</b></li>
        </ul>
      `
        },
        {
          id: "calendario_academico2",
          patterns: [/primeros parciales/],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìù Primeros parciales: <b>1 al 6 de septiembre</b></li>
        </ul>
      `
        },

        {
          id: "calendario_academico3",
          patterns: [/segundos parciales/],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìù Segundos parciales: <b>20 al 25 de octubre</b></li>
        </ul>
      `
        },
        {
          id: "calendario_academico4",
          patterns: [/examenes finales/],
          answer: `
        <b>Calendario acad√©mico ciclo 02-2025:</b>
        <ul>
          <li>üìö Ex√°menes finales: <b>2 al 8 de diciembre</b></li>
        </ul>
      `
        },
        {
          id: "politicas_evaluacion",
          patterns: [/politica(s)?/, /evaluacion/, /reglas/],
          answer: `
        <b>Pol√≠ticas de evaluaci√≥n:</b>
        <ol>
          <li>Solo los alumnos matriculados correctamente en NetCampus podr√°n evaluarse.</li>
          <li>Se requiere al menos un <b>80% de asistencia</b> para tener derecho a examen final.</li>
        </ol>
      `
        },
        {
          id: "soporte_plataformas",
          patterns: [/soporte plataforma/, /ayuda plataforma/,
            /problema en netcampus/
          ],
          answer: `
        <b>Soporte de plataformas:</b>
        <ol>
          <li>Verifica tu conexi√≥n a internet y actualiza la p√°gina.</li>
          <li>Consulta la secci√≥n de <b>Preguntas Frecuentes</b> en NetCampus.</li>
          <li>Si el problema persiste, env√≠a un correo a <i>soporte@universidad.edu</i> con captura de pantalla y descripci√≥n.</li>
          <li>Horario de atenci√≥n: lunes a viernes, 8:00‚Äì17:00.</li>
        </ol>
      `
        },
        {
          id: "dato_curioso",
          patterns: [/dato curioso/, /curiosidad/],
          answer: `
        ¬øSab√≠as que el primer curso en l√≠nea de la universidad se imparti√≥ en <b>2008</b>?
        Desde entonces, se han desarrollado m√°s de 300 cursos virtuales.
      `
        },
        {
          id: "frase",
          patterns: [/frase motivadora/, /motivacion/, /inspir(a|acion)/],
          answer: `
        ‚Äú<i>El aprendizaje es un viaje continuo; cada pregunta es un paso hacia adelante.</i>‚Äù
      `
        },
        {
          id: "chiste",
          patterns: [/chiste/, /broma/],
          answer: `
        ‚Äî ¬øPor qu√© el estudiante llev√≥ una escalera a clase?<br>
        ‚Äî ¬°Porque quer√≠a llegar al nivel superior! üòÑ
      `
        },
        {
          id: "gracias",
          patterns: [/gracias/],
          answer: `
        De nada, consultame cuando quieras! estoy aqu√≠ para ayudar üòÑ<br>
      `
        },
        {
          id: "despedida",
          patterns: [/bye/, /adios/, /hasta luego/, /gracias/, /nos vemos/],
          answer: `
               ¬°Fue un gusto conversar contigo! üòä<br>
              Recuerda que la <b>Unidad TAC</b> siempre est√° aqu√≠ para apoyarte en tu aprendizaje y en el uso de NetCampus.<br>
               ¬°Te esperamos pronto para seguir innovando juntos! üöÄ
    `
        },
        
        // -- Aqu√≠ comienzan las preguntas propuestas por Melvin  ---
        // ===============================
        // INTENTS NUEVOS (Docentes)
        // ===============================
        // 1) Activar automatriculaci√≥n en un curso
      {
        id: "prof_auto_matriculacion_activar",
        patterns: [
          /activar.*auto.*matricul/,
          /habilitar.*auto.*inscrip/,
          /inscripci(o|√≥)n.*autom(a|√°)tica/,
          /metodos.*inscrip.*auto/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Activar la automatriculaci√≥n en tu curso:</b>
            <ol>
              <li>Entra al curso y abre <b>Participantes</b>.</li>
              <li>En el men√∫ de <b>Participantes</b>, elige <b>M√©todos de inscripci√≥n</b>.</li>
              <li>Localiza <b>Automatriculaci√≥n (estudiante)</b> y haz clic en el <b>√≠cono de ojo</b> para activarla.</li>
              <li>Haz clic en el <b>engrane</b> para configurar: clave de inscripci√≥n (opcional), duraci√≥n de matr√≠cula, l√≠mites y mensaje de bienvenida.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // 2) Matricular usuarios manualmente
      {
        id: "prof_matricular_manual",
        patterns: [
          /matricular.*manual/,
          /inscribir.*manual/,
          /agregar.*usuario.*curso/,
          /anadir.*participante/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Matricular usuarios manualmente:</b>
            <ol>
              <li>Entra al curso ‚Üí <b>Participantes</b> ‚Üí <b>M√©todos de inscripci√≥n</b>.</li>
              <li>Verifica que <b>Matr√≠cula manual</b> est√° <b>activa</b> (ojo abierto).</li>
              <li>Haz clic en <b>Matricular usuarios</b> y busca a las personas.</li>
              <li>Asigna el <b>rol</b> (p. ej., Estudiante) y, si quieres, define <b>fecha/duraci√≥n</b> de matr√≠cula.</li>
              <li>Confirma con <b>Matricular usuarios seleccionados</b>.</li>
            </ol>
          </div>
        `
      },

      // 3) A√±adir la descripci√≥n del curso (duplicado en doc, consolidado)
      {
        id: "prof_descripcion_curso",
        patterns: [
          /descripcion.*curso/,
          /resumen.*curso/,
          /presentacion.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>A√±adir/editar la descripci√≥n del curso:</b>
            <ol>
              <li>Entra al curso y abre <b>Configuraci√≥n del curso</b>.</li>
              <li>En <b>General</b>, edita el campo <b>Descripci√≥n</b> con objetivos, contenidos y metodolog√≠a.</li>
              <li>(Opcional) Adjunta <b>im√°genes/archivos</b> de apoyo.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // 4) Entregar tareas (perspectiva estudiante, √∫til para docentes al dar indicaciones)
      {
        id: "alumno_entregar_tarea_20mb",
        patterns: [
          /entregar.*tarea/,
          /subir.*tarea/,
          /enviar.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>C√≥mo entregar una tarea (l√≠mite t√≠pico 20&nbsp;MB):</b>
            <ol>
              <li>Abre la actividad <b>Tarea</b> y lee las <b>instrucciones</b> y <b>fecha l√≠mite</b>.</li>
              <li>Haz clic en <b>Agregar entrega</b>.</li>
              <li>Adjunta tu archivo (respeta el <b>tama√±o m√°ximo</b> indicado).</li>
              <li>Haz clic en <b>Guardar cambios</b> y, si corresponde, <b>Enviar tarea</b> para confirmar.</li>
            </ol>
          </div>
        `
      },

      // 5) Resolver cuestionarios (estudiante)
      {
        id: "alumno_resolver_cuestionario",
        patterns: [
          /resolver.*cuestionario/,
          /rendir.*examen.*virtual/,
          /intentar.*cuestionario/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>C√≥mo resolver un cuestionario:</b>
            <ol>
              <li>Abre el <b>cuestionario</b> y revisa <b>apertura</b>, <b>l√≠mite de tiempo</b> e <b>intentos</b>.</li>
              <li>Haz clic en <b>Intentar resolver ahora</b>.</li>
              <li>Responde cada pregunta (opci√≥n m√∫ltiple, V/F, ensayo, etc.).</li>
              <li>Selecciona <b>Finalizar intento</b> y revisa tus respuestas.</li>
              <li>Confirma con <b>Enviar todo y terminar</b>.</li>
            </ol>
          </div>
        `
      },

      // 6) Configurar la calificaci√≥n del curso (libro de calificaciones)
      {
        id: "prof_calificaciones_configurar",
        patterns: [
          /configurar.*calificaci(o|√≥)n.*curso/,
          /ajust(es|ar).*libro.*calific/,
          /peso.*actividades.*calific/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Configurar el libro de calificaciones:</b>
            <ol>
              <li>Entra al curso ‚Üí <b>Calificaciones</b> ‚Üí <b>Ajustes del libro</b>/<b>Configuraci√≥n del curso</b>.</li>
              <li>Crea <b>categor√≠as</b> (p. ej., Ex√°menes, Tareas, Participaci√≥n).</li>
              <li>Define el <b>m√©todo de c√°lculo</b> (suma, media ponderada, etc.) y los <b>pesos</b>.</li>
              <li>Coloca cada actividad en su <b>categor√≠a</b> y verifica el <b>c√°lculo final</b>.</li>
              <li>Guarda los cambios y revisa el <b>Informe del calificador</b>.</li>
            </ol>
          </div>
        `
      },

      // 7) Crear una tarea (si ya existe, puedes unificar/actualizar el intent actual).
      //  Descripci√≥n: ESTA TIENE CONFLICTO con el intent "crear_tarea" de arriba, que es para estudiantes.
      {
        id: "prof_crear_tarea_pasoapaso",
        patterns: [
          /crear.*tarea.*docente/,
          /configurar.*tarea.*docente/,
          /actividad.*tarea.*docente/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear una tarea (docente):</b>
            <ol>
              <li>Activa la <b>edici√≥n</b> en el curso.</li>
              <li><b>A√±adir una actividad o un recurso</b> ‚Üí <b>Tarea</b>.</li>
              <li>Define <b>Nombre</b>, <b>Descripci√≥n</b> e <b>instrucciones</b>.</li>
              <li>Configura <b>fechas</b> (desde, entrega, l√≠mite) y <b>tama√±o m√°x. de archivo</b>.</li>
              <li>Ajusta <b>Calificaci√≥n</b> (puntuaci√≥n y categor√≠a) y <b>Tipos de entrega</b> (archivo/texto).</li>
              <li>Guarda con <b>Guardar y mostrar</b>.</li>
            </ol>
          </div>
        `
      },

      // 8) Foro: preguntas generadoras y configuraci√≥n b√°sica
      // ESTA NO FUNCIONA!! SEPA DIOS PORQUE
      {
        id: "prof_foro_preguntas_generadoras",
        patterns: [
          /preguntas.*generadoras.*foro/,
          /crear.*foro.*debate/,
          /configurar.*foro.*discusion/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear un foro con preguntas generadoras:</b>
            <ol>
              <li>Activa la <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Foro</b>.</li>
              <li>Escribe <b>Nombre</b> y <b>Descripci√≥n</b> (instrucciones, reglas y tus preguntas generadoras).</li>
              <li>Elige <b>Tipo</b>: <i>Debate sencillo</i> para un √∫nico tema.</li>
              <li>Define <b>Disponibilidad</b> (fecha de entrega y fecha l√≠mite si requieres cierre).</li>
              <li>En <b>Adjuntos</b>, fija cantidad y tama√±o, y habilita el <b>recuento de palabras</b> si lo necesitas.</li>
              <li>En <b>Suscripci√≥n</b>, usa <i>forzosa</i> si quieres asegurar la participaci√≥n.</li>
              <li>En <b>Evaluaci√≥n</b>, asigna <b>Escala</b> o <b>puntos</b> seg√∫n tu r√∫brica.</li>
              <li><b>Guardar cambios y regresar al curso</b>.</li>
            </ol>
          </div>
        `
      },

      // 9) Reutilizaci√≥n/Importaci√≥n de cursos
      {
        id: "prof_reutilizacion_importacion",
        patterns: [
          /reutilizaci(o|√≥)n.*curso/,
          /importar.*curso/,
          /copiar.*contenido.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Importar (reutilizar) contenido de otro curso:</b>
            <ol>
              <li>Abre <b>dos ventanas</b>: curso origen (viejo) y curso destino (vac√≠o).</li>
              <li>En el curso destino: <b>M√°s</b> ‚Üí <b>Reutilizaci√≥n de curso</b> ‚Üí <b>Importar</b>.</li>
              <li>Busca el curso origen por <b>c√≥digo</b> (p. ej., <i>ADM-3200-01</i>) y selecci√≥nalo.</li>
              <li>Elige qu√© <b>elementos copiar</b> (desmarca lo que no quieres: enlaces de Teams/WhatsApp, etc.).</li>
              <li>Revisa el resumen (verde = se copiar√°) y confirma con <b>Realizar la importaci√≥n</b>.</li>
            </ol>
          </div>
        `
      },

      // 10) Crear actividad H5P
      {
        id: "prof_crear_h5p",
        patterns: [
          /crear.*h5p/,
          /contenido.*interactivo.*h5p/,
          /agregar.*h5p/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear una actividad H5P:</b>
            <ol>
              <li>Activa <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Contenido interactivo H5P</b>.</li>
              <li>Asigna un <b>nombre</b> y crea el contenido en el <b>editor H5P</b> o <b>sube</b> un archivo .h5p.</li>
              <li>Configura <b>calificaci√≥n</b>, <b>intentos</b> y <b>restricciones de acceso</b>.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // 11) Reiniciar curso (reset)
      {
        id: "prof_reiniciar_curso",
        patterns: [
          /reiniciar.*curso/,
          /reset.*curso/,
          /revitalizar.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Reiniciar un curso para un nuevo ciclo:</b>
            <ol>
              <li>En el curso: <b>M√°s</b> ‚Üí <b>Reutilizaci√≥n de curso</b> ‚Üí <b>Reiniciar curso</b>.</li>
              <li>Elige qu√© <b>reiniciar</b>: calificaciones, actividades, usuarios, foros, etc.</li>
              <li>Confirma. El curso queda limpio para el nuevo ciclo, <b>manteniendo la estructura</b>.</li>
            </ol>
          </div>
        `
      },

      // 12) Dise√±ar y aplicar cuestionarios (resumen docente)
      {
        id: "prof_diseniar_aplicar_cuestionarios",
        patterns: [
          /disenar.*cuestionario/,
          /aplicar.*cuestionario/,
          /configurar.*examen.*moodle/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Dise√±ar y aplicar un cuestionario:</b>
            <ol>
              <li>Activa <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Cuestionario</b>.</li>
              <li>Define <b>nombre</b>, <b>descripci√≥n</b>, <b>tiempos</b> e <b>intentos</b>.</li>
              <li>Agrega preguntas nuevas o desde el <b>banco de preguntas</b>.</li>
              <li>Configura <b>calificaci√≥n</b> (p. ej., calificaci√≥n m√°s alta o promedio).</li>
              <li>Publica. Los estudiantes podr√°n responder seg√∫n las fechas establecidas.</li>
            </ol>
          </div>
        `
      },

      // 13) Filtrar entregas (calificadas/pendientes) en Tarea
      {
        id: "prof_filtrar_entregas_tarea",
        patterns: [
          /filtrar.*entregas/,
          /ver.*entregas.*calificadas/,
          /pendientes.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Filtrar entregas en una Tarea:</b>
            <ol>
              <li>Abre la <b>Tarea</b> ‚Üí <b>Ver todas las entregas</b>.</li>
              <li>Usa los <b>filtros</b> para mostrar: <i>calificadas</i>, <i>pendientes</i>, <i>con retraso</i>.</li>
              <li>Gestiona y revisa m√°s r√°pido lo que necesitas evaluar.</li>
            </ol>
          </div>
        `
      },

      // 14) Penalizaciones por entregas tard√≠as
      {
        id: "prof_penalizacion_retraso",
        patterns: [
          /penalizaci(o|√≥)n.*tard[i√≠]as/,
          /descuento.*entrega.*tarde/,
          /fecha.*limite.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Configurar penalizaci√≥n por entrega tard√≠a:</b>
            <ol>
              <li>En la <b>Tarea</b>, edita la actividad.</li>
              <li>Activa <b>Fecha l√≠mite</b> y establece la pol√≠tica de <b>penalizaci√≥n</b> (si tu configuraci√≥n la ofrece) o define el manejo de <b>env√≠os fuera de plazo</b>.</li>
              <li>Guarda y prueba con un usuario de ejemplo para validar el flujo.</li>
            </ol>
          </div>
        `
      },

      // 15) Crear cuestionario paso a paso (detalle)
      {
        id: "prof_crear_cuestionario_pasoapaso",
        patterns: [
          /crear.*cuestionario/,
          /nuevo.*cuestionario/,
          /configurar.*cuestionario/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear un cuestionario (paso a paso):</b>
            <ol>
              <li>Activa <b>edici√≥n</b> ‚Üí <b>A√±adir actividad</b> ‚Üí <b>Cuestionario</b> ‚Üí <b>Agregar</b>.</li>
              <li>Completa <b>Nombre</b> y <b>Descripci√≥n</b> (instrucciones claras para estudiantes).</li>
              <li>Define <b>apertura/cierre</b>, <b>tiempo l√≠mite</b> e <b>intentos permitidos</b>.</li>
              <li>Configura <b>calificaci√≥n</b> (puntaje m√°ximo, m√©todo de agregaci√≥n de intentos).</li>
              <li>Guarda y luego entra a <b>Editar cuestionario</b> para agregar preguntas (nuevas o del banco).</li>
              <li>Ordena preguntas y ajusta la <b>puntuaci√≥n</b> de cada una ‚Üí <b>Guardar</b> y publicar.</li>
            </ol>
          </div>
        `
      },

      // 16) Pre-crear/simular intentos (seg√∫n disponibilidad)
      {
        id: "prof_precrear_intentos",
        patterns: [
          /pre.*crear.*intentos.*cuestionario/,
          /simular.*intentos/,
          /probar.*cuestionario.*docente/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Probar un cuestionario antes de publicarlo:</b>
            <ol>
              <li>Abre el <b>cuestionario</b> ya configurado.</li>
              <li>Usa <b>Vista previa</b> para simular un intento y verificar tiempos, navegaci√≥n y retroalimentaci√≥n.</li>
              <li>En <b>Configuraci√≥n ‚Üí Calificaci√≥n</b>, ajusta <b>intentos permitidos</b> si necesitas m√∫ltiples ejecuciones.</li>
              <li>(Opcional) Prueba con una <b>cuenta de estudiante de prueba</b> para ver el flujo real.</li>
            </ol>
            <div style="font-size:.95em;opacity:.85">Nota: Algunas instalaciones incluyen opciones avanzadas de simulaci√≥n; si no las ves, usa Vista previa.</div>
          </div>
        `
      },

      // 17) Gestionar banco de preguntas
      {
        id: "prof_banco_preguntas_gestion",
        patterns: [
          /banco.*preguntas/,
          /gestionar.*preguntas.*cuestionario/,
          /importar.*exportar.*preguntas/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Gestionar el banco de preguntas:</b>
            <ol>
              <li>Ve a <b>Banco de preguntas</b> ‚Üí <b>Preguntas</b>.</li>
              <li><b>Crear:</b> <i>Agregar</i> ‚Üí tipo (opci√≥n m√∫ltiple, V/F, etc.), redacta enunciado, respuestas y calificaci√≥n ‚Üí <b>Guardar</b>.</li>
              <li><b>Duplicar:</b> selecciona la pregunta ‚Üí <b>Duplicar</b> ‚Üí ajusta y guarda.</li>
              <li><b>Filtrar:</b> por <b>categor√≠a</b>, <b>tipo</b> o <b>palabras clave</b> para encontrar m√°s r√°pido.</li>
              <li><b>Compartir:</b> <i>Exportar</i> (Moodle XML, GIFT) para usar en otros cursos; <i>Importar</i> para traer bancos externos.</li>
            </ol>
          </div>
        `
      },

      // 18) Accesibilidad: descripciones en im√°genes
      {
        id: "prof_accesibilidad_descripcion_imagen",
        patterns: [
          /accesibilidad.*imagen/,
          /descripcion.*larga.*imagen/,
          /texto.*alternativo.*imagen/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Accesibilidad en im√°genes (alt y descripci√≥n larga):</b>
            <ol>
              <li>En el editor, inserta o selecciona la <b>imagen</b>.</li>
              <li>Abre <b>Propiedades de la imagen</b> ‚Üí completa <b>Texto alternativo</b> (breve y descriptivo).</li>
              <li>Si necesitas m√°s detalle, agrega <b>Descripci√≥n larga</b> (Long description) con contexto y prop√≥sito.</li>
              <li>Guarda y verifica con un <b>lector de pantalla</b> si es posible.</li>
            </ol>
          </div>
        `
      },

      // 19) Plantillas de respaldo (backup)
      {
        id: "prof_plantillas_respaldo",
        patterns: [
          /plantilla.*respaldo/,
          /copia.*seguridad.*curso/,
          /backup.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Crear y usar plantillas de respaldo:</b>
            <ol>
              <li>En el curso: <b>M√°s</b> ‚Üí <b>Reutilizaci√≥n de curso</b> ‚Üí <b>Copia de seguridad</b>.</li>
              <li>Selecciona qu√© incluir: <b>actividades</b>, <b>bloques</b>, <b>calificaciones</b>, <b>usuarios</b>, etc.</li>
              <li>Guarda la <b>plantilla</b> con un nombre claro (p. ej., ‚ÄúRespaldo-base-sin-usuarios‚Äù).</li>
              <li>Reutiliza esa plantilla para crear <b>backups consistentes y r√°pidos</b>.</li>
            </ol>
          </div>
        `
      },

      // 20) EXTRA: Exportar calificaciones
      {
        id: "prof_exportar_calificaciones",
        patterns: [
          /exportar.*calificaci/,
          /descargar.*calificaci/,
          /informe.*calificador.*exportar/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Exportar calificaciones del curso:</b>
            <ol>
              <li>Entra a <b>Calificaciones</b> ‚Üí <b>Exportar</b>.</li>
              <li>Elige formato (CSV, XLSX, etc.) y <b>rango de √≠tems</b>.</li>
              <li>Configura separadores/encabezados si usas CSV.</li>
              <li>Haz clic en <b>Descargar</b> y verifica el archivo.</li>
            </ol>
          </div>
        `
      },

      // 21) EXTRA: Mostrar/Ocultar curso para estudiantes
      {
        id: "prof_mostrar_ocultar_curso",
        patterns: [
          /ocultar.*curso/,
          /mostrar.*curso/,
          /disponibilidad.*curso/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Ocultar o mostrar el curso a estudiantes:</b>
            <ol>
              <li>Abre <b>Configuraci√≥n del curso</b>.</li>
              <li>En <b>Visibilidad del curso</b>, elige <b>Ocultar</b> o <b>Mostrar</b>.</li>
              <li>Guarda. <span style="opacity:.85">√ötil antes del inicio o para mantenimiento.</span></li>
            </ol>
          </div>
        `
      },

      // 22) EXTRA: Ajustar tama√±o m√°ximo de archivo en Tarea
      {
        id: "prof_tarea_tamano_archivo",
        patterns: [
          /tam(a|√°)no.*archivo.*tarea/,
          /limite.*mb.*tarea/,
          /peso.*archivo.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Cambiar el tama√±o m√°ximo de archivo en una Tarea:</b>
            <ol>
              <li>Editar la <b>Tarea</b> ‚Üí secci√≥n <b>Tipos de entrega</b>.</li>
              <li>Ajusta <b>Tama√±o m√°ximo de env√≠o</b> (p. ej., 20&nbsp;MB).</li>
              <li>Guarda y comunica el l√≠mite a tus estudiantes.</li>
            </ol>
          </div>
        `
      },

      // 23) EXTRA: Reabrir intento o dar intento extra en cuestionario
      {
        id: "prof_cuestionario_intento_extra",
        patterns: [
          /dar.*intento.*extra/,
          /reabrir.*intento.*cuestionario/,
          /permitir.*otro.*intento/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Conceder un intento extra en un cuestionario:</b>
            <ol>
              <li>Abre el <b>cuestionario</b> ‚Üí <b>Intentos</b> / <b>Resultados</b>.</li>
              <li>Localiza al estudiante y usa <b>anulaci√≥n de usuario</b> (override) para cambiar <b>intentos</b> y/o <b>tiempo</b>.</li>
              <li>Guarda. Informa al estudiante para que vuelva a ingresar.</li>
            </ol>
          </div>
        `
      },

      // 24) EXTRA: Permitir reenv√≠o (reapertura) de tarea
      {
        id: "prof_tarea_reenvio",
        patterns: [
          /permitir.*reenv[i√≠]o.*tarea/,
          /reabrir.*tarea/,
          /otro.*env[i√≠]o.*tarea/
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Permitir reenv√≠o de una Tarea:</b>
            <ol>
              <li>Editar la <b>Tarea</b> ‚Üí ajusta <b>Fecha de entrega</b>/<b>Fecha l√≠mite</b> o habilita <b>Requerir que los estudiantes hagan clic en Enviar</b> para controlar estados.</li>
              <li>En <b>Calificaci√≥n</b>, habilita <b>flujo de calificaci√≥n</b> si quieres controlar la liberaci√≥n de notas.</li>
              <li>Guarda y avisa al estudiante que ya puede volver a enviar.</li>
            </ol>
          </div>
        `
      }
      ,

      // Aqui comienzan las preguntas dise√±adas para los estudiantes las que paso Melvin.
      // ---------------------------------------------------------
      // Permite al estudiante editar su perfil (datos b√°sicos).
      // Patrones: verbos comunes (modificar/editar/cambiar) + "perfil".
      // Nota: mantenemos t√©rminos gen√©ricos para capturar variaciones.
      // ---------------------------------------------------------
      {
        id: "alumno_modificar_perfil",
        patterns: [
          /modificar.*perfil/i,
          /editar.*perfil.*estudiante/i,
          /cambiar.*informaci[o√≥]n.*perfil/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Modificar tu perfil en Moodle:</b>
            <ol>
              <li>Inicia sesi√≥n en la plataforma.</li>
              <li>Haz clic en tu nombre o foto (esquina superior derecha).</li>
              <li>Selecciona <b>Perfil</b> y luego <b>Editar perfil</b>.</li>
              <li>Cambia los datos que necesites: nombre, correo, descripci√≥n, idioma, etc.</li>
              <li>Haz clic en <b>Guardar cambios</b> para aplicar la actualizaci√≥n.</li>
            </ol>
          </div>
        `
      },

      // -----------------------------------------------------------------
      // Cambiar/a√±adir foto de perfil.
      // Patrones: "agregar/subir/cambiar" + "foto" + "perfil".
      // Consejo: si tu UI usa compresi√≥n/recorte, podr√≠as enlazar un tip.
      // -----------------------------------------------------------------
      {
        id: "alumno_foto_perfil",
        patterns: [
          /agregar.*foto.*perfil/i,
          /subir.*foto.*perfil/i,
          /cambiar.*foto.*perfil/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>A√±adir o cambiar tu foto de perfil:</b>
            <ol>
              <li>Ve a <b>Perfil ‚Üí Editar perfil</b>.</li>
              <li>En la secci√≥n <b>Imagen del usuario</b>, arrastra tu foto o haz clic en <b>Agregar archivo</b>.</li>
              <li>Sube la imagen y guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // --------------------------------------------------------------------
      // Recuperaci√≥n de contrase√±a (flujo est√°ndar de "olvid√© mi contrase√±a").
      // Patrones: cubrir "recuperar", "olvid√©", "resetear" + (contrase√±a/clave).
      // Nota: incluimos (√±/n) y acentos en regex para robustez b√°sica.
      // --------------------------------------------------------------------
      {
        id: "alumno_recuperar_contrasena",
        patterns: [
          /recuperar.*contrase[n√±]a/i,
          /olvid[e√©].*clave/i,
          /resetear.*clave/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Recuperar tu contrase√±a:</b>
            <ol>
              <li>En la pantalla de inicio, haz clic en <b>¬øOlvid√≥ su nombre de usuario o contrase√±a?</b>.</li>
              <li>Ingresa tu correo o usuario registrado.</li>
              <li>Revisa tu correo y sigue el enlace para crear una nueva clave.</li>
            </ol>
          </div>
        `
      },

      // ----------------------------------------------------------------------
      // Explica qu√© son las "etiquetas" (√°rea de texto y medios) en el curso.
      // Patrones: consultas tipo "¬øqu√© son?" y verbos "usar/insertar".
      // Nota: √∫til para estudiantes curiosos y tambi√©n asistentes de c√°tedra.
      // ----------------------------------------------------------------------
      {
        id: "alumno_etiquetas",
        patterns: [
          /qu[e√©].*son.*etiquetas/i,
          /usar.*etiquetas.*curso/i,
          /insertar.*texto.*imagen.*curso/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Usar etiquetas en un curso:</b>
            <ol>
              <li>Activa la <b>edici√≥n</b> en el curso.</li>
              <li>Haz clic en <b>A√±adir actividad o recurso</b>.</li>
              <li>Selecciona <b>√Årea de texto y medios</b> (etiqueta).</li>
              <li>Escribe el contenido: texto, imagen, video o enlace.</li>
              <li>Guarda los cambios.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------------
      // Auto-matriculaci√≥n (sin o con clave si el curso la requiere).
      // Patrones: "auto-matricular", "inscripci√≥n autom√°tica", "unirme".
      // Consejo: en tu instancia cambia "Moodle" por "Sinapsis" si aplica.
      // -------------------------------------------------------------

      //Esta tiene conflicto con el intent "matricularme con clave" de arriba.
      // Lo ideal ser√≠a unificar ambos en uno solo, pero como no tengo claro el flujo
      {
        id: "alumno_autoregistro",
        patterns: [
          /auto.*matricul(ar|aci[o√≥]n)/i,
          /inscripci[o√≥]n.*autom[a√°]tica/i,
          /unirme.*curso.*sin.*clave/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Auto-matricularte en un curso:</b>
            <ol>
              <li>Inicia sesi√≥n en Moodle.</li>
              <li>Abre el listado de cursos disponibles.</li>
              <li>Haz clic en el curso que te interese y pulsa <b>Matricularme</b>.</li>
              <li>Si pide clave, introd√∫cela y confirma.</li>
              <li>El curso quedar√° en tu p√°gina principal.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------------------
      // Matriculaci√≥n cuando el curso tiene clave (incluye fuente de claves).
      // Patrones: "matricularme con clave", "acceso con clave", "inscribirme".
      // Nota: personaliza el paso de "d√≥nde ver claves" a tu instituci√≥n.
      // -------------------------------------------------------------------

      //Esta tiene conflicto con el intent "matricularme con clave" de arriba.
      // Lo ideal ser√≠a unificar ambos en uno solo, pero como no tengo claro el flujo
      {
        id: "alumno_matricula_clave",
        patterns: [
          /matricul(ar|aci[o√≥]n).*clave/i,
          /inscribirme.*clave/i,
          /acceso.*curso.*clave/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Matricularte con clave de acceso:</b>
            <ol>
              <li>Inicia sesi√≥n en Moodle.</li>
              <li>Busca el curso y haz clic en √©l.</li>
              <li>Consulta la p√°gina oficial donde publican las <b>claves de acceso</b> por d√≠a.</li>
              <li>Introduce la clave en Moodle y confirma tu matr√≠cula.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------
      // D√≥nde ver las calificaciones del curso (libreta).
      // Patrones: "ver notas/calificaciones".
      // -------------------------------------------------
      {
        id: "alumno_ver_calificaciones",
        patterns: [
          /ver.*calificaciones/i,
          /notas.*curso/i,
          /calificaci[o√≥]n.*tareas/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Ver tus calificaciones:</b>
            <ol>
              <li>Entra al curso.</li>
              <li>Abre el men√∫ lateral y haz clic en <b>Calificaciones</b>.</li>
              <li>Ver√°s tu libreta con tareas, ex√°menes y comentarios del profesor.</li>
            </ol>
          </div>
        `
      },

      // ----------------------------------------------
      // Participaci√≥n en foros (crear y responder).
      // Patrones: "participar/publicar/debate".
      // ----------------------------------------------

      //ESTA NO FUNCIONA!! SEPA DIOS PORQUE
      {
        id: "alumno_foro_participar",
        patterns: [
          /participar.*foro/i,
          /publicar.*foro/i,
          /debate.*foro/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Participar en un foro:</b>
            <ol>
              <li>Entra al curso y busca la actividad <b>Foro</b>.</li>
              <li>Haz clic en el t√≠tulo del foro.</li>
              <li>Abre un tema existente o crea uno nuevo.</li>
              <li>Escribe tu mensaje, adjunta archivos si es necesario.</li>
              <li>Pulsa <b>Enviar al foro</b>.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------------------
      // Notificaciones y retroalimentaci√≥n (campana + preferencias).
      // Patrones: t√©rminos gen√©ricos "notificaciones/avisos/mensajes".
      // -------------------------------------------------------------------
      {
        id: "alumno_notificaciones",
        patterns: [
          /notificaciones/i,
          /avisos.*plataforma/i,
          /mensajes.*moodle/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Recibir notificaciones:</b>
            <ol>
              <li>Haz clic en la <b>campana de notificaciones</b> en la barra superior.</li>
              <li>Activa notificaciones por correo o SMS en <b>Perfil ‚Üí Preferencias ‚Üí Preferencias de Notificaciones</b>.</li>
            </ol>
          </div>
        `
      },

      // -------------------------------------------------------
      // Ordenar/organizar cursos en el √°rea personal del alumno.
      // Patrones: "ordenar/organizar/ver ordenados".
      // -------------------------------------------------------
      {
        id: "alumno_ordenar_cursos",
        patterns: [
          /ordenar.*cursos/i,
          /organizar.*cursos/i,
          /ver.*cursos.*ordenados/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Ordenar tus cursos:</b>
            <ol>
              <li>Ve a la p√°gina principal de tu √°rea personal.</li>
              <li>En <b>Mis cursos</b>, selecciona ordenar por fecha o alfab√©ticamente.</li>
            </ol>
          </div>
        `
      },

      // --------------------------------------------------------------------
      // Consultar entregas y penalizaciones por retraso en tareas.
      // Patrones: "consultar/ver/revisar" + "entregas/retraso".
      // --------------------------------------------------------------------
      {
        id: "alumno_consultar_entregas",
        patterns: [
          /consultar.*entregas/i,
          /ver.*tareas.*entregadas/i,
          /revisar.*retraso.*tareas/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>Consultar tus entregas y penalizaciones:</b>
            <ol>
              <li>Entra a tu curso.</li>
              <li>Ve a la secci√≥n <b>Tareas</b>.</li>
              <li>Haz clic en la tarea para ver fecha, estado y penalizaciones si hubo retrasos.</li>
            </ol>
          </div>
        `
      },

      // --------------------------------------------------------------------------------
      // Reproducci√≥n de contenidos H5P en app m√≥vil (autoplay sujeto a compatibilidad).
      // Patrones: "h5p m√≥vil", "reproducir h5p app", "h5p autom√°tico".
      // Nota: aclaramos que no todos los tipos admiten autoplay por restricciones.
      // --------------------------------------------------------------------------------
      {
        id: "alumno_h5p_movil",
        patterns: [
          /h5p.*m[o√≥]vil/i,
          /reproducir.*h5p.*app/i,
          /h5p.*autom[a√°]tico/i
        ],
        answer: `
          <div class="respuesta-bloque">
            <b>H5P en la app m√≥vil:</b>
            <ol>
              <li>Abre la actividad H5P en la app Moodle.</li>
              <li>Si el contenido permite reproducci√≥n autom√°tica, habil√≠tala desde el editor H5P en la web.</li>
              <li>Ten en cuenta que no todos los contenidos H5P admiten autoplay en m√≥viles.</li>
            </ol>
          </div>
        `
      }



      ];

      // --- UI wiring ---
      const msgs = document.getElementById('nc-msgs');
      // ‚õ≥Ô∏è eliminamos la l√≠nea que declaraba 'form' (ya no se usa)
      const input = document.getElementById('nc-input'); // ‚Üê una sola vez
      const sendBtn = document.getElementById('nc-send');

      const typeMessage = text => {
        let i = 0;
        const div = document.createElement('div');
        div.className = 'mensaje-inicial'; // Usamos clase para aplicar estilos din√°micos
        msgs.appendChild(div);

        const interval = setInterval(() => {
          div.innerHTML = text.substring(0, i) +
            "<span class='cursor-escribiendo'></span>";
          i++;
          msgs.scrollTop = msgs.scrollHeight;
          if (i > text.length) {
            clearInterval(interval);
            div.innerHTML = text;
          }
        }, 30);
      };
      typeMessage("üëã ¬°Hola! Soy el Chatbot TAC. Preg√∫ntame sobre el proyecto, la Unidad TAC o el calendario acad√©mico.");



      let typingEl = null;

        function showTyping(){
          // crea una burbuja de bot con puntos animados
          const html = `<span class="nc-typing">
                          <span class="nc-dot-typing"></span>
                          <span class="nc-dot-typing"></span>
                          <span class="nc-dot-typing"></span>
                        </span>`;
          const el = document.createElement('div');
          el.className = 'nc-bubble nc-bot';
          el.innerHTML = html;
          document.getElementById('nc-msgs').appendChild(el);
          document.getElementById('nc-msgs').scrollTop = document.getElementById('nc-msgs').scrollHeight;
          typingEl = el;
        }

        function hideTyping(){
          if(typingEl && typingEl.parentNode){
            typingEl.parentNode.removeChild(typingEl);
            typingEl = null;
          }
        }


        // --- Tema claro/oscuro ---
        const ncRoot  = document.getElementById('nc-bot'); // tiene la clase "nc"
        const themeBtn= document.getElementById('nc-theme');

        function applyTheme(theme){
          if (theme === 'dark') {
            ncRoot.classList.add('nc-dark');
            themeBtn.textContent = '‚òÄÔ∏è Modo claro';
            themeBtn.setAttribute('aria-pressed','true');
          } else {
            ncRoot.classList.remove('nc-dark');
            themeBtn.textContent = 'üåô Modo oscuro';
            themeBtn.setAttribute('aria-pressed','false');
          }
          localStorage.setItem('ncTheme', theme);
        }

        // Preferencia inicial: guardada o del sistema
        const savedTheme = localStorage.getItem('ncTheme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        applyTheme(savedTheme ? savedTheme : (prefersDark ? 'dark' : 'light'));

        // Toggle al hacer click
        themeBtn.addEventListener('click', ()=>{
          const isDark = ncRoot.classList.contains('nc-dark');
          applyTheme(isDark ? 'light' : 'dark');
        });



      const bubble = (html, who) => {
        const p = document.createElement('div');
        p.className = 'nc-bubble ' + (who === 'me' ? 'nc-me' : 'nc-bot');
        p.innerHTML = html;
        const msgs = document.getElementById('nc-msgs');
        msgs.appendChild(p);
        msgs.scrollTop = msgs.scrollHeight;
        return p; // ‚Üê ahora devolvemos el elemento
      };



      const matchIntent = text => {
        const q = norm(text);
        for (const intent of INTENTS) {
          if (intent.patterns.some(rx => rx.test(q))) return intent;
        }
        return null;
      };

      function renderSuggestions(intentId, bubbleEl){
        const items = SUGGESTIONS[intentId];
        if (!items || !items.length || !bubbleEl) return;
        const wrap = document.createElement('div');
        wrap.className = 'nc-suggest';
        items.forEach(it=>{
          const b = document.createElement('button');
          b.type = 'button';
          b.className = 'nc-chip';
          b.textContent = it.label;
          b.addEventListener('click', ()=> sendText(it.q));
          wrap.appendChild(b);
        });
        bubbleEl.appendChild(wrap);
      }

      function renderMedia(intentId, bubbleEl){
        const m = MEDIA[intentId];
        if (!m || !m.img) return;
        const box = document.createElement('div');
        box.className = 'nc-media';
        box.innerHTML = `<img src="${m.img}" alt="${m.alt || ''}">`;
        bubbleEl.appendChild(box);
      }



      function handleSend() {
      const t = input.value.trim();
      if (!t) return;
      bubble(t, 'me');
      input.value = '';

      showTyping();
      setTimeout(() => {
        try {
          const intent = matchIntent(t);
          hideTyping();
          if (intent) {
            const el = bubble(intent.answer, 'bot');     // ‚Üê guardamos el nodo
            renderSuggestions(intent.id, el);  
            renderMedia(intent.id, el);          
          } else {
            bubble("<i>No tengo esa respuesta a√∫n. Prueba con: ‚Äúproyecto‚Äù, ‚Äúunidad TAC‚Äù, ‚Äúcalendario acad√©mico‚Äù o ‚Äúsoporte plataformas‚Äù.</i>", 'bot');
          }
        } catch (err) {
          hideTyping();
          bubble(`<span style="color:#b00020">‚ö†Ô∏è Error: ${err.message}</span>`, 'bot');
          console.error(err);
        }
}, 500);
 // puedes subir un poco el delay para que se note el typing
    }


      sendBtn.addEventListener('click', handleSend);

      // Utilidad para enviar texto program√°ticamente
        function sendText(t){
          bubble(t,'me');
          input.value = '';
          showTyping();
          setTimeout(()=>{
            try{
              const intent = matchIntent(t);
              hideTyping();
              if (intent) {
                const el = bubble(intent.answer,'bot');
                renderSuggestions(intent.id, el);
                renderMedia(intent.id, el);
              } else {
                bubble("<i>No tengo esa respuesta a√∫n. Prueba con: ‚Äúproyecto‚Äù, ‚Äúunidad TAC‚Äù, ‚Äúcalendario acad√©mico‚Äù o ‚Äúsoporte plataformas‚Äù.</i>", 'bot');
              }
            }catch(err){
              hideTyping();
              bubble(`<span style="color:#b00020">‚ö†Ô∏è Error: ${err.message}</span>`,'bot');
              console.error(err);
            }
          }, 500);

        }


        // Listeners de chips
        document.querySelectorAll('.nc-chip').forEach(ch=>{
          ch.addEventListener('click', ()=>{
            const q = ch.getAttribute('data-q') || '';
            if(q) sendText(q);
          });
        });

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          handleSend();
        }
      });
    })();
  </script>
</p>